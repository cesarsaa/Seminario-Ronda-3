<!DOCTYPE html>
<!-- saved from url=(0070)https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/ -->
<html class="js jetpack-lazy-images-js-enabled" lang="en-US" prefix="og: http://ogp.me/ns#"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Convolutional Neural Networks in R | R-bloggers</title>
<!-- This site is running CAOS for Wordpress -->

<!-- Open Graph Meta Tags generated by MashShare 3.7.7 - https://mashshare.net -->
<meta property="og:type" content="article"> 
<meta property="og:title" content="Convolutional Neural Networks in R">
<meta property="og:description" content="&lt;div style = &quot;width:60%; display: inline-block; float:left; &quot;&gt; Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you can freely access here, so give it a try! The plan here is to experiment with convolutional neural networks (CNNs), a form ...&lt;/div&gt;&lt;div style = &quot;width: 40%; display: inline-block; float:right;&quot;&gt;&lt;img src=&#39; https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=1108&#39; width = &quot;200&quot;  style = &quot;padding: 10px;&quot; /&gt;&lt;/div&gt;&lt;div style=&quot;clear: both;&quot;&gt;&lt;/div&gt;">
<meta property="og:url" content="https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/">
<meta property="og:site_name" content="R-bloggers">
<meta property="article:publisher" content="https://www.facebook.com/rbloggers/">
<meta property="article:published_time" content="2018-07-08T05:05:23-06:00">
<meta property="article:modified_time" content="2018-07-08T05:05:23-06:00">
<meta property="og:updated_time" content="2018-07-08T05:05:23-06:00">
<!-- Open Graph Meta Tags generated by MashShare 3.7.7 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.7.7 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Convolutional Neural Networks in R">
<meta name="twitter:description" content="&lt;div style = &quot;width:60%; display: inline-block; float:left; &quot;&gt; Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you can freely access here, so give it a try! The plan here is to experiment with convolutional neural networks (CNNs), a form ...&lt;/div&gt;&lt;div style = &quot;width: 40%; display: inline-block; float:right;&quot;&gt;&lt;img src=&#39; https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=1108&#39; width = &quot;200&quot;  style = &quot;padding: 10px;&quot; /&gt;&lt;/div&gt;&lt;div style=&quot;clear: both;&quot;&gt;&lt;/div&gt;">
<meta name="twitter:site" content="@Rbloggers">
<!-- Twitter Card generated by MashShare 3.7.7 - https://www.mashshare.net -->


<!-- All In One SEO Pack 3.7.1[216,276] -->
<meta name="description" content="Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you">


<script src="./Ejemplo_RBloggers_files/sdk.js.descarga" async="" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./Ejemplo_RBloggers_files/vglnk.js.descarga"></script><script async="" src="./Ejemplo_RBloggers_files/analytics.js.descarga"></script><script src="./Ejemplo_RBloggers_files/pAx-dKbLyle7umPnDyx7D0pQbKA.js.descarga"></script><script src="./Ejemplo_RBloggers_files/XwzxUUnPwVYUc-cNUnfA25jqByU.js.descarga"></script><link rel="canonical" href="https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/">
<!-- All In One SEO Pack -->
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="preconnect" href="https://www.google-analytics.com/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.r-bloggers.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.3"}};
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="snp_styles_reset-css" href="./Ejemplo_RBloggers_files/reset.min.css" type="text/css" media="all">
<link rel="stylesheet" id="fancybox2-css" href="./Ejemplo_RBloggers_files/jquery.fancybox.min.css" type="text/css" media="all">
<link rel="stylesheet" id="snp_styles_theme6-css" href="./Ejemplo_RBloggers_files/theme6.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="./Ejemplo_RBloggers_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="mashsb-styles-css" href="./Ejemplo_RBloggers_files/mashsb.min.css" type="text/css" media="all">
<style id="mashsb-styles-inline-css" type="text/css">
.mashsb-count {color:#cccccc;}@media only screen and (min-width:568px){.mashsb-buttons a {min-width: 177px;}}
</style>
<link rel="stylesheet" id="wpt-twitter-feed-css" href="./Ejemplo_RBloggers_files/twitter-feed.css" type="text/css" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="mh-google-fonts-css" href="./Ejemplo_RBloggers_files/css" type="text/css" media="all">
<link rel="stylesheet" id="mh-style-css" href="./Ejemplo_RBloggers_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="./Ejemplo_RBloggers_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="./Ejemplo_RBloggers_files/jquery.js.descarga" id="jquery-core-js"></script>
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/related-posts.min.js.descarga" id="jetpack_related-posts-js"></script>
<script type="text/javascript" id="mashsb-js-extra">
/* <![CDATA[ */
var mashsb = {"shares":"0","round_shares":"1","animate_shares":"0","dynamic_buttons":"0","share_url":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/","title":"Convolutional+Neural+Networks+in+R","image":null,"desc":"<div style = \"width:60%; display: inline-block; float:left; \"> Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you can freely access here, so give it a try! The plan here is to experiment with convolutional neural networks (CNNs), a form ...<\/div><div style = \"width: 40%; display: inline-block; float:right;\"><img src=' https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/cats_dogs_trimmed_ppt_compress.png?w=1108' width = \"200\"  style = \"padding: 10px;\" \/><\/div><div style=\"clear: both;\"><\/div>","hashtag":"Rbloggers","subscribe":"link","subscribe_url":"https:\/\/feedburner.google.com\/fb\/a\/mailverify?uri=RBloggers","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0","nonce":"8f861cdec0","postid":"164887","servertime":"1606138160","ajaxurl":"https:\/\/www.r-bloggers.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/mashsb.min.js.descarga" id="mashsb-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/scripts.js.descarga" id="mh-scripts-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/analytics.js(1).descarga" id="caos-analytics-js"></script>
<script type="text/javascript" id="caos-analytics-js-after">
    



    window.ga = window.ga || function () {(ga.q = ga.q || []).push(arguments);};
    ga.l = +new Date;

    ga('create', 'UA-419807-53', {"cookieName":"caosLocalGa","cookieDomain":"www.r-bloggers.com","cookieExpires":2592000,"cookieFlags":"samesite=none;secure"});
        ga('set', 'anonymizeIp', true);    ga('send', 'pageview');
                


    function _caosLt(event)
    {
        if (typeof gtag !== 'function' || typeof ga !== 'function') { return; }

        var eventLink = event.srcElement || event.target;

        /* Loop up the DOM tree through parent elements if clicked element is not a link (eg: an image inside a link) */
        while(eventLink && (typeof eventLink.tagName == 'undefined' || eventLink.tagName.toLowerCase() !== 'a' || !eventLink.href)) { eventLink = eventLink.parentNode; }

        /* if a link with valid href has been clicked */
        if (eventLink && eventLink.href) { var link = eventLink.href;
            /* Only if it is an external link */
            if (link.indexOf(location.host) === -1 && !link.match(/^javascript\:/i)) { /* Is actual target set and not _(self|parent|top)? */ var target = (eventLink.target && !eventLink.target.match(/^_(self|parent|top)$/i)) ? eventLink.target : false;
                /* Assume a target if Ctrl|shift|meta-click */
                if (event.ctrlKey || event.shiftKey || event.metaKey || event.which === 2) { target = '_blank'; }

                var hbrun = false; // tracker has not yet run

                /* HitCallback to open link in same window after tracker */
                var hitBack = function () {
                    /* run once only */ if (hbrun) return;
                    hbrun = true; window.location.href = link;
                };

                if (target) {
                    /* If target opens a new window then just track */
                                        ga('send', 'event', 'Outbound Link Tracking', 'click', link);
                                    } else {
                    /* Prevent standard click, track then open */
                    event.preventDefault ? event.preventDefault() : event.returnValue = !1;
                    /* send event with callback */
                                        ga('send', 'event', 'Outbound Link Tracking', 'click', link, { 'transport': 'beacon', 'hitCallback': hitBack });
                                        /* Run hitCallback again if GA takes longer than 1 second */
                    setTimeout(hitBack, 1000);
                }
            }
        }
    }

    var _window = window;

    /* Use "click" if touchscreen device, else "mousedown" */
    var _caosLtEvent = ('ontouchstart' in _window) ? 'click' : 'mousedown';

    /* Attach the event to all clicks in the document after page has loaded */
    _window.addEventListener ? _window.addEventListener('load', function () {document.body.addEventListener(_caosLtEvent, _caosLt, !1);}, !1) : _window.attachEvent && _window.attachEvent('onload', function () { document.body.attachEvent('on' + _caosLtEvent, _caosLt); });
</script>
<link rel="https://api.w.org/" href="https://www.r-bloggers.com/wp-json/"><link rel="alternate" type="application/json" href="https://www.r-bloggers.com/wp-json/wp/v2/posts/164887"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.r-bloggers.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.r-bloggers.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Establishing Meaningful Performance Comparisons between R and Python" href="https://www.r-bloggers.com/2018/07/establishing-meaningful-performance-comparisons-between-r-and-python/">
<link rel="next" title="Speed up your R Work" href="https://www.r-bloggers.com/2018/07/speed-up-your-r-work/">
<meta name="generator" content="WordPress 5.5.3">
<link rel="shortlink" href="https://www.r-bloggers.com/?p=164887">
<link rel="alternate" type="application/json+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2F2018%2F07%2Fconvolutional-neural-networks-in-r%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2F2018%2F07%2Fconvolutional-neural-networks-in-r%2F&amp;format=xml">

<link rel="dns-prefetch" href="https://i0.wp.com/">
<link rel="dns-prefetch" href="https://i1.wp.com/">
<link rel="dns-prefetch" href="https://i2.wp.com/">
<link rel="dns-prefetch" href="https://c0.wp.com/">
<style type="text/css">img#wpstats{display:none}</style><!--[if lt IE 9]>
<script src="https://www.r-bloggers.com/wp-content/themes/mh-corporate-basic/js/css3-mediaqueries.js"></script>
<![endif]-->
			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script type="text/javascript">
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		<link rel="amphtml" href="https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/amp/">
<!-- WordPress Facebook Open Graph protocol plugin (WPFBOGP v2.0.13) http://rynoweb.com/wordpress-plugins/ -->
<meta property="fb:app_id" content="143207055763488">
<meta property="og:image" content="https://www.r-bloggers.com/wp-content/uploads/2016/08/R_single_01-200-1.png">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=1108">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=1108">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+%5Cleqslant+0.25+&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=694&amp;h=347">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=1108">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=1108">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=1108">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=1108">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&amp;h=210">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&amp;h=235">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=1108">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=p_%7Bbird%7D+&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=L_2+&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=W%5E%7B%281%29%7D%2C+W%5E%7B%282%29%7D%2C+...+%2C+W%5E%7B%28l%29%7D&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=0">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=CE+%3D+-+%5Csum_%7Bi+%3D+1%7D%5E%7Bn%7D+y_i+%5Ccdot+log%28%5Chat%7By_i%7D%29+&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=f%28z%29+&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1">
<meta property="og:image" content="https://s0.wp.com/latex.php?latex=z+%3D+b+%2B+%5Csum_%7Bi+%3D+1%7D%5E%7Bm%7D+W_i+%5Ccdot+x_i+&amp;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=1108">
<meta property="og:image" content="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=1108">
<!-- // end wpfbogp -->
<link rel="icon" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=32%2C32&amp;ssl=1" sizes="32x32">
<link rel="icon" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=192%2C192&amp;ssl=1" sizes="192x192">
<link rel="apple-touch-icon" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=180%2C180&amp;ssl=1">
<meta name="msapplication-TileImage" content="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=270%2C270&amp;ssl=1">
<link rel="preload" href="./Ejemplo_RBloggers_files/wp-emoji-release.min.js.descarga" as="script"><link rel="preload" href="./Ejemplo_RBloggers_files/mashsb.min.js.descarga" as="script"><link rel="preload" href="./Ejemplo_RBloggers_files/scripts.js.descarga" as="script"><link rel="preload" href="./Ejemplo_RBloggers_files/analytics.js(1).descarga" as="script"><link rel="preload" href="./Ejemplo_RBloggers_files/reset.min.css" as="style"><link rel="preload" href="./Ejemplo_RBloggers_files/jquery.fancybox.min.css" as="style"><link rel="preload" href="./Ejemplo_RBloggers_files/theme6.css" as="style"><link rel="preload" href="./Ejemplo_RBloggers_files/mashsb.min.css" as="style"><link rel="preload" href="./Ejemplo_RBloggers_files/twitter-feed.css" as="style"><link rel="preload" href="./Ejemplo_RBloggers_files/style.css" as="style">		<style type="text/css" id="wp-custom-css">
			hr {
    margin-top: 2px;
    margin-bottom: 2px;
}


pre, code {
  overflow: auto;
  white-space: pre;
	    font-family: "Source Code Pro","Liberation Mono","Courier New",Courier,monospace;
    font-size: 12px;
    line-height: 1.35em;
    overflow: hidden;
    /*white-space: pre-wrap;*/
    word-wrap: break-word;
    margin: 0 0 20px 0;
    padding: 0;
    position: relative;
    text-align: left;
    direction: ltr;
	  overflow-x: auto;
	  padding-left: 17px;
}

table {
  display: block;
  overflow-x: auto;
  white-space: nowrap;
}

/*deal with mathjax overflow*/
.MathJax_Display {
    overflow-x: auto;
    overflow-y: hidden; /* need to verify this works well*/
    display: block;
}		</style>
		<script src="./Ejemplo_RBloggers_files/wp-emoji-release.min.js.descarga" type="text/javascript" defer=""></script><link rel="stylesheet" type="text/css" href="./Ejemplo_RBloggers_files/enlighterjs.min.css" media="all"><script src="./Ejemplo_RBloggers_files/enlighterjs.min.js.descarga" async=""></script><style type="text/css" data-fbcssmodules="css:fb.css.basecss:fb.css.dialog css:fb.css.iframewidget">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#043b87;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}</style><link rel="prefetch" href="https://www.r-bloggers.com/"><link rel="prefetch" href="https://www.r-bloggers.com/about/"><link rel="prefetch" href="https://www.r-bloggers.com/add-your-blog/"><link rel="prefetch" href="https://www.r-bloggers.com/how-to-learn-r-2/"><link rel="prefetch" href="https://www.r-bloggers.com/contact-us/"><link rel="prefetch" href="https://www.r-bloggers.com/author/francisco-lima/"><link rel="prefetch" href="https://www.r-bloggers.com/category/r-bloggers/"><link rel="prefetch" href="https://www.r-bloggers.com/2018/07/pca-vs-autoencoders-for-dimensionality-reduction/"><link rel="prefetch" href="https://www.r-bloggers.com/2015/12/how-to-write-the-first-for-loop-in-r/"></head>
<body class="post-template-default single single-post postid-164887 single-format-standard">
<div class="mh-container"><div class="slicknav_menu"><a href="https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/#" aria-haspopup="true" tabindex="0" class="slicknav_btn slicknav_collapsed" style="outline: none;"><span class="slicknav_menutxt">MENU</span><span class="slicknav_icon"><span class="slicknav_icon-bar"></span><span class="slicknav_icon-bar"></span><span class="slicknav_icon-bar"></span></span></a><nav class="slicknav_nav slicknav_hidden" style="display: none;" aria-hidden="true" role="menu">
		<div class="menu-top-nav-container"><ul class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-48314"><a href="https://www.r-bloggers.com/" role="menuitem">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-92333"><a href="https://www.r-bloggers.com/about/" role="menuitem">About</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-50111"><a href="https://feeds.feedburner.com/RBloggers" role="menuitem">RSS</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48313"><a href="https://www.r-bloggers.com/add-your-blog/" role="menuitem">add your blog!</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-111419"><a href="https://www.r-bloggers.com/how-to-learn-r-2/" role="menuitem">Learn R</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-75513 slicknav_collapsed slicknav_parent"><a href="https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/#" role="menuitem" aria-haspopup="true" tabindex="-1" class="slicknav_item" style="outline: none;"><a href="https://www.r-users.com/">R jobs</a>
<span class="slicknav_arrow">►</span></a><ul class="sub-menu slicknav_hidden" role="menu" style="display: none;" aria-hidden="true">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76945"><a href="https://www.r-users.com/submit-job/" role="menuitem" tabindex="-1">Submit a new job (it’s free)</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76946"><a href="https://www.r-users.com/" role="menuitem" tabindex="-1">Browse latest jobs (also free)</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48311"><a href="https://www.r-bloggers.com/contact-us/" role="menuitem">Contact us</a></li>
</ul></div>	</nav></div>
<div class="wrapper-corporate">
<header class="header-wrap">
	<a href="https://www.r-bloggers.com/" title="R-bloggers" rel="home">
<div class="logo-wrap" role="banner">
<img src="./Ejemplo_RBloggers_files/R_02.webp" height="90" width="290" alt="R-bloggers">
<div class="logo logo-overlay">
<h1 class="logo-name">R-bloggers</h1>
<h2 class="logo-desc">R news and tutorials contributed by hundreds of R bloggers</h2>
</div>
</div>
</a>
	<nav class="main-nav clearfix">
		<div class="menu-top-nav-container"><ul id="menu-top-nav" class="menu"><li id="menu-item-48314" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-48314"><a href="https://www.r-bloggers.com/">Home</a></li>
<li id="menu-item-92333" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-92333"><a href="https://www.r-bloggers.com/about/">About</a></li>
<li id="menu-item-50111" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-50111"><a href="https://feeds.feedburner.com/RBloggers">RSS</a></li>
<li id="menu-item-48313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48313"><a href="https://www.r-bloggers.com/add-your-blog/">add your blog!</a></li>
<li id="menu-item-111419" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-111419"><a href="https://www.r-bloggers.com/how-to-learn-r-2/">Learn R</a></li>
<li id="menu-item-75513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-75513"><a href="https://www.r-users.com/">R jobs</a>
<ul class="sub-menu">
	<li id="menu-item-76945" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76945"><a href="https://www.r-users.com/submit-job/">Submit a new job (it’s free)</a></li>
	<li id="menu-item-76946" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76946"><a href="https://www.r-users.com/">Browse latest jobs (also free)</a></li>
</ul>
</li>
<li id="menu-item-48311" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48311"><a href="https://www.r-bloggers.com/contact-us/">Contact us</a></li>
</ul></div>	</nav>
</header>
<div class="mh-wrapper clearfix">
	<div class="mh-content left"><article class="post-164887 post type-post status-publish format-standard hentry category-r-bloggers">
	<header class="post-header">
		<h1 class="entry-title">Convolutional Neural Networks in R</h1>
		<p class="meta post-meta">Posted on <span class="updated">July 8, 2018</span>  by <span class="vcard author"><a class="fn" href="https://www.r-bloggers.com/author/francisco-lima/">Francisco Lima</a></span>  in <a href="https://www.r-bloggers.com/category/r-bloggers/" rel="category tag">R bloggers</a> | 0 Comments</p>
	</header>
	<div class="entry clearfix">
				<p class="syndicated-attribution"><!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

</p><div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/"> poissonisfish</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="https://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><p></p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2F2018%2F07%2Fconvolutional-neural-networks-in-r%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-small mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Convolutional%20Neural%20Networks%20in%20R&amp;url=https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/&amp;via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-small mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.7.7--><figure data-shortcode="caption" id="attachment_4454" style="width: 1650px" class="wp-caption aligncenter"><img data-attachment-id="4454" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/cats_dogs_trimmed_ppt_compress/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578" data-orig-size="1650,765" data-comments-opened="1" data-image-title="cats_dogs_trimmed_ppt_compress" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578?w=1024" class="alignnone size-full wp-image-4454 jetpack-lazy-image jetpack-lazy-image--handled" src="./Ejemplo_RBloggers_files/cats_dogs_trimmed_ppt_compress.png" alt="cats_dogs_trimmed_ppt_compress" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578 1108w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=300 300w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=768 768w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=1024 1024w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png 1650w" data-recalc-dims="1" data-lazy-loaded="1" sizes="(max-width: 1108px) 100vw, 1108px"><noscript><img data-attachment-id="4454" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/cats_dogs_trimmed_ppt_compress/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578" data-orig-size="1650,765" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="cats_dogs_trimmed_ppt_compress" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578?w=1024" class="alignnone size-full wp-image-4454" src="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578" alt="cats_dogs_trimmed_ppt_compress" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=578 1108w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=300 300w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=768 768w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png?w=1024 1024w, https://poissonisfish.files.wordpress.com/2018/07/cats_dogs_trimmed_ppt_compress.png 1650w" sizes="(max-width: 1108px) 100vw, 1108px"   data-recalc-dims="1" /></noscript><figcaption class="wp-caption-text">Can we teach a computer to distinguish cats and dogs? [<a href="https://arkvets.com.au/seasonal-allergies-dogs-cats/" rel="nofollow" target="_blank">source</a>]</figcaption></figure>
<p style="text-align:left;">Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you can freely access <a href="https://www.datacamp.com/community/tutorials/gflasso-R?tap_a=5644-dce66f&amp;tap_s=10907-287229" rel="nofollow" target="_blank">here</a>, so give it a try!</p>
<p style="text-align:left;">The plan here is to experiment with convolutional neural networks (CNNs), a form of deep learning. CNNs underlie most advanced recognition algorithms used by the major tech giants. The recent development of back-end optimization tools and hardware (from Intel, NVIDIA and Google to name a few) now enables training CNNs on conventional laptop machines, hence accessible to a broader audience.</p>
<p style="text-align:left;">Today you will construct a binary classifier that can distinguish between dogs and cats from a set of 25,000 pictures, using the <a href="https://keras.rstudio.com/" rel="nofollow" target="_blank">Keras R interface</a>&nbsp;powered by the&nbsp;<a href="https://www.tensorflow.org/" rel="nofollow" target="_blank">TensorFlow</a> back-end engine. The code is available from a dedicated&nbsp;<a href="https://github.com/monogenea/CNNtutorial" rel="nofollow" target="_blank">repo</a> so you don’t have to copy-paste the snippets below. &nbsp;If you fall short of RAM&nbsp;please consider adapting the script as to use less pictures or split, process and save them in separate instances. Finally, I encourage you to use the RStudio terminal shell to fetch the <a href="https://www.kaggle.com/c/dogs-vs-cats" rel="nofollow" target="_blank">Dogs vs. Cats dataset</a> from Kaggle via its new API feature. I will provide more detailed instructions below. If you want to pass the theory, scroll all the way down to the “Let’s get started with R” section. Enjoy!</p>
<h2>Neural Networks</h2>
<p style="text-align:left;">Driverless cars were out there as far back as <a href="https://www.theverge.com/2016/11/27/13752344/alvinn-self-driving-car-1989-cmu-navlab" rel="nofollow" target="_blank">1989</a>. Neural networks (NNs) have been around for a long time, so what triggered this craze around artificial intelligence and deep learning in recent years? The answer partly lies in <a href="http://www.mooreslaw.org/" rel="nofollow" target="_blank">Moore’s law</a> and the remarkable improvement of hardware and computing power – we can now do a lot more with a lot less. The concept of NNs, as the name suggests, was inspired by the network of our own brain neurons. Neurons are very long cells, each with protrusions called dendrites that receive and propagate electrochemical signals from and to surrounding neurons, respectively. As a result, our brain cells form flexible, robust communication networks that sequentially process cascading inputs. This distributive process, akin to an assembly line, is supportive of sophisticated cognitive abilities such as music playing and painting.</p>
<p style="text-align:left;">There is enough about NNs to write books and I do not intend to re-invent the wheel here. There are great free resources you can learn from, to master both basic and advanced concepts. I recommend the <a href="https://software.intel.com/en-us/ai-academy/students/kits/deep-learning-501" rel="nofollow" target="_blank">Intel® AI Academy</a>, the &nbsp;<a href="https://www.coursera.org/learn/machine-learning" rel="nofollow" target="_blank">Coursera Machine Learning</a>&nbsp;course taught by Andrew Ng and <a href="https://www.datacamp.com/?tap_a=5644-dce66f&amp;tap_s=10907-287229" rel="nofollow" target="_blank">DataCamp</a> for the Python enthusiasts. I will cover only some key features pertaining to classification problems.</p>
<h3>Basic architecture</h3>
<p style="text-align:left;">A NN typically contains one input layer, one or more hidden layers, and an output layer. The input layer consists of your <em>p</em> predictors, or input units / nodes. Needless to say, it is generally good practice to center, scale and transform predictors, if not at least to speed up the optimization procedure. These input units can be connected to one or more hidden units in the first hidden layer. A hidden layer that is fully connected to the preceding layer&nbsp;is designated dense. In the diagram below, both hidden layers are dense.</p>
<p></p><figure data-shortcode="caption" id="attachment_4452" style="width: 597px" class="wp-caption aligncenter"><img data-attachment-id="4452" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/tikz11/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578" data-orig-size="597,324" data-comments-opened="1" data-image-title="tikz11" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578?w=597" class="alignnone size-full wp-image-4452 jetpack-lazy-image" src="./Ejemplo_RBloggers_files/tikz11.png" alt="tikz11" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png 597w, https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=300 300w" data-recalc-dims="1" data-lazy-sizes="(max-width: 597px) 100vw, 597px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4452" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/tikz11/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578" data-orig-size="597,324" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="tikz11" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578?w=597" class="alignnone size-full wp-image-4452" src="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=578" alt="tikz11" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/tikz11.png 597w, https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/tikz11.png?w=300 300w" sizes="(max-width: 597px) 100vw, 597px"   data-recalc-dims="1" /></noscript><figcaption class="wp-caption-text">Schematic representation of a neural network with two hidden layers [<a href="http://neuralnetworksanddeeplearning.com/chap1.html" rel="nofollow" target="_blank">source</a>]</figcaption></figure>
<p>The output layer computes the prediction, and the number of units therein is determined by the problem in hands. Conventionally, a binary classification problem requires a single output unit (as shown above), whereas a multiclass problem with <em>k</em> classes will require&nbsp;<em>k</em>&nbsp;corresponding output units. The former can simply use a sigmoid function to directly compute a probability, while the latter usually requires a softmax transformation, whereby all values across all <em>k</em> output units sum up to one and can thus be treated as probabilities. Rather than having categorical predictions you can retrieve the actual probabilities, which are much more informative, and inspect their quality using calibration plots and lift charts. These can be discussed in a future tutorial.</p>
<h3>Weights</h3>
<p>Every arrow displayed in the diagram above passes on an input that is associated with a weight. Each weight is essentially one of many coefficient estimates that contribute to the regressions computed in the nodes the corresponding arrows point to.&nbsp;These are unknown parameters that must be tuned by the model as to minimize the loss function, using an optimization procedure. In effect, for any particular observation each neuron can be mathematically represented as <img src="./Ejemplo_RBloggers_files/latex.php" alt="z = b + \sum_{i = 1}^{m} W_i \cdot x_i " title="z = b + \sum_{i = 1}^{m} W_i \cdot x_i " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=z+%3D+b+%2B+%5Csum_%7Bi+%3D+1%7D%5E%7Bm%7D+W_i+%5Ccdot+x_i+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=z+%3D+b+%2B+%5Csum_%7Bi+%3D+1%7D%5E%7Bm%7D+W_i+%5Ccdot+x_i+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="z = b + \sum_{i = 1}^{m} W_i \cdot x_i " title="z = b + \sum_{i = 1}^{m} W_i \cdot x_i " class="latex" /></noscript>, where <em>b&nbsp;</em>denotes the intercept (also known as bias, and technically a weight itself) and&nbsp;<em>W&nbsp;</em>and <em>x </em>are&nbsp;<em>m</em>-long vectors carrying the weights and values from all <em>m&nbsp;</em>inputs, respectively. Before training, all weights are initialized with random values.</p>
<h3>Activation functions</h3>
<p>So far we have been assuming each unit carries a linear regression model, but there is more to that.&nbsp;Every hidden unit is equipped with a sort of toggle switch that applies a filter on the regression output. In this context, different types of toggle switches are designated activation functions, i.e. <img src="./Ejemplo_RBloggers_files/latex(1).php" alt="f(z) " title="f(z) " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=f%28z%29+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=f%28z%29+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="f(z) " title="f(z) " class="latex" /></noscript> based on the mathematical representation above. On / off and high-pass toggle switches, for example, are encoded by sigmoid and rectified linear unit (ReLU) activation functions, respectively. The activation function in the output layer is particularly important, as I wrote before, as it must be picked according to the problem in hands.</p>
<h3>Loss and optimization</h3>
<p>So far we worked our way downstream the network, covering most elements necessary to make a prediction. However, we still did not discuss the actual training and weight fine-tuning. We need two things in place prior to training: <em>i</em>) a measure of goodness-of-fit, that compares predictions and known labels over all training observations, and <em>ii</em>) an optimization method that computes the gradient descent, essentially tweaking all weight estimates simultaneously, in the directions that improve the goodness-of-fit. For each of these we have loss functions and optimizers, respectively.&nbsp;There are many types of loss functions, all aimed at quantifying prediction error. Later we will use cross-entropy, <img src="./Ejemplo_RBloggers_files/latex(2).php" alt="CE = - \sum_{i = 1}^{n} y_i \cdot log(\hat{y_i}) " title="CE = - \sum_{i = 1}^{n} y_i \cdot log(\hat{y_i}) " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=CE+%3D+-+%5Csum_%7Bi+%3D+1%7D%5E%7Bn%7D+y_i+%5Ccdot+log%28%5Chat%7By_i%7D%29+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=CE+%3D+-+%5Csum_%7Bi+%3D+1%7D%5E%7Bn%7D+y_i+%5Ccdot+log%28%5Chat%7By_i%7D%29+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="CE = - \sum_{i = 1}^{n} y_i \cdot log(\hat{y_i}) " title="CE = - \sum_{i = 1}^{n} y_i \cdot log(\hat{y_i}) " class="latex" /></noscript>. As for optimization, we will use Adam, a popular stochastic optimization method. Great, but there is yet no explanation of how optimization resolves the dependencies among neurons in successive layers.</p>
<h3>Backpropagation</h3>
<p>Recap: to learn the parameters contained in the weight vectors that span <em>l</em> layers (<img src="./Ejemplo_RBloggers_files/latex(3).php" alt="W^{(1)}, W^{(2)}, ... , W^{(l)}" title="W^{(1)}, W^{(2)}, ... , W^{(l)}" class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=W%5E%7B%281%29%7D%2C+W%5E%7B%282%29%7D%2C+...+%2C+W%5E%7B%28l%29%7D&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=0" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=W%5E%7B%281%29%7D%2C+W%5E%7B%282%29%7D%2C+...+%2C+W%5E%7B%28l%29%7D&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=0" alt="W^{(1)}, W^{(2)}, ... , W^{(l)}" title="W^{(1)}, W^{(2)}, ... , W^{(l)}" class="latex" /></noscript>), the model must plug in the predictors that cascade downstream and generate predictions, which in turn are contrasted to the actual labels.&nbsp;At this point, the loss function kicks in and gauges error.</p>
<p>To estimate all weights while considering their dependencies, backpropagation makes its way upstream, applying the chain rule. This chain rule calculates the gradients (i.e. partial derivatives w.r.t. the different weights) that reduce the error “dragged” from the output layer, a process governed by the optimizer.</p>
<p>This all covers the building block of training – evaluating observations, establishing predictions and subsequently tuning weights to minimize error. Training is nothing but repeating it and updating the weights until convergence of the optimizer or reaching a limit. But how many observations exactly should we use in each iteration?</p>
<h3>Batch size</h3>
<p>There are three main options for how many observations to be used in each training step. Stochastic batch, mini-batch and full-batch feed in single observations, samples or the entire training set in each training step, respectively. In terms of runtime, the stochastic batch is faster compared to the full-batch. In terms of accuracy in the optimization (i.e. tweaking weights in the right direction), the full-batch is more accurate than the stochastic batch. In both cases, mini-batch sits in between. While there is no optimal method, it is important to consider the number of epochs can aid in extending iterations beyond the size of the training set.</p>
<h3>Regularization</h3>
<p style="text-align:left;">NNs must learn a myriad of parameters, bringing about the perils of overfitting. This problem can be tackled with various forms of regularization that constrain model flexibility. Weight decay acts much like <img src="./Ejemplo_RBloggers_files/latex(4).php" alt="L_2 " title="L_2 " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=L_2+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=L_2+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="L_2 " title="L_2 " class="latex" /></noscript> or LASSO penalties, introducing a budget for the magnitude of the weights. Dropout, to be used later, randomly drops connections based on a pre-specified probability.</p>
<p style="text-align:left;">If you want to gain some more intuition about NNs, here is an interesting interactive <a href="https://playground.tensorflow.org/" rel="nofollow" target="_blank">page</a> from TensorFlow.</p>
<h2>Convolutional Neural Networks</h2>
<p style="text-align:left;">Convolutional neural networks (CNNs) are a special type of NNs well poised for image processing and framed on the principles discussed above. The ‘convolutional’ in the name owes to separate square patches of pixels in a image being processed through filters. As a result, the model can mathematically capture key visual cues such as textures and edges that help discerning classes. The beak of a bird, for example, is highly discriminative of birds among animals. In the example depicted below, the CNN would likely process beak-shaped structures along a chain of transformations involving convolution, pooling and flattening into layers, the last of which would see the relevant neurons activated, ideally resulting in <img src="./Ejemplo_RBloggers_files/latex(5).php" alt="p_{bird} " title="p_{bird} " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=p_%7Bbird%7D+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=p_%7Bbird%7D+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="p_{bird} " title="p_{bird} " class="latex" /></noscript> being the largest probability among the competing classes.</p>
<p></p><figure data-shortcode="caption" id="attachment_4468" style="width: 1000px" class="wp-caption aligncenter"><img data-attachment-id="4468" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/cover/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578" data-orig-size="1000,341" data-comments-opened="1" data-image-title="Cover" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578?w=1000" class=" size-full wp-image-4468 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/cover.png" alt="Cover" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/cover.png 1000w, https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=300 300w, https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=768 768w" data-recalc-dims="1" data-lazy-sizes="(max-width: 1000px) 100vw, 1000px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4468" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/cover/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578" data-orig-size="1000,341" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="Cover" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578?w=1000" class=" size-full wp-image-4468 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=578" alt="Cover" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/cover.png 1000w, https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=300 300w, https://poissonisfish.files.wordpress.com/2018/07/cover.png?w=768 768w" sizes="(max-width: 1000px) 100vw, 1000px"   data-recalc-dims="1" /></noscript><figcaption class="wp-caption-text">Schematic representation of a convolutional neural network [<a href="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/" rel="nofollow" target="_blank">source</a>]</figcaption></figure>
<p>Note that images can be represented as numerical matrices, based on color intensity. Monochromatic images are processed with 2D convolutional layers, whereas colored ones require 3D convolutional layers – we will use the former. Also, note that the depth of the convolutional layers is determined by the total number of filters. Now briefly, some important CNN features.</p>
<h3>Kernel, stride and padding</h3>
<p>Kernels, also known as filters, convolve square blocks of pixels into scalars in subsequent convolutional layers.&nbsp;In the animation below, you have a 3 x 3 kernel with ones running on the diagonal and off-diagonal, scanning an image from left to right, top to bottom.</p>
<p></p><figure data-shortcode="caption" id="attachment_4561" style="width: 321px" class="wp-caption aligncenter"><img loading="lazy" data-attachment-id="4561" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/convolution_schematic/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&amp;resize=321%2C235#038;h=235" data-orig-size="268,196" data-comments-opened="1" data-image-title="convolution_schematic" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&amp;resize=321%2C235#038;h=235?w=268" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&amp;resize=321%2C235#038;h=235?w=268" class="  wp-image-4561 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/convolution_schematic.gif" alt="convolution_schematic" width="321" height="235" data-recalc-dims="1" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&amp;is-pending-load=1#038;resize=321%2C235#038;h=235" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" data-attachment-id="4561" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/convolution_schematic/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&#038;resize=321%2C235#038;h=235" data-orig-size="268,196" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="convolution_schematic" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&#038;resize=321%2C235#038;h=235?w=268" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&#038;resize=321%2C235#038;h=235?w=268" class="  wp-image-4561 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/convolution_schematic.gif?w=321&#038;resize=321%2C235#038;h=235" alt="convolution_schematic" width="321" height="235" data-recalc-dims="1" /></noscript><figcaption class="wp-caption-text">Example of image convolution [<a href="http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution" rel="nofollow" target="_blank">source</a>]</figcaption></figure>
<p>Throughout the process, the kernel performs element-wise multiplication and sums up all products, into a single value passed to the subsequent convolutional layer.</p>
<p>Note that the kernel is moving a pixel at a time. This is the stride,&nbsp;the stepsize of the sliding window the kernel uses to convolve. Larger strides implicate more granular, smaller convolved features.</p>
<p>Looking back to the figure above, note how central pixels are overrepresented compared to those lying on the edges of the image – while the very central pixel is picked up in every scan, the top-left pixel is picked up only once. More importantly, we might not be interested in downsampling. Padding, by adding zero-valued pixels around the borders of the image solves both problems by capturing more details and maintaining size, respectively.</p>
<h3>Pool</h3>
<p>Pooling is a strategic downsampling from a convolutional layer, rendering representations of predominant features in lower dimensions, preventing overfitting and alleviating computational demand. Two major types of pooling are average and max pooling. Provided a kernel and a stride, pooling amounts to convolution but instead taking either the average or maximum value per frame. Here is an illustrative example.</p>
<figure data-shortcode="caption" id="attachment_4565" style="width: 449px" class="wp-caption aligncenter"><img loading="lazy" data-attachment-id="4565" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/maxpool/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&amp;resize=449%2C210#038;h=210" data-orig-size="787,368" data-comments-opened="1" data-image-title="maxpool" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&amp;resize=449%2C210#038;h=210?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&amp;resize=449%2C210#038;h=210?w=787" class="  wp-image-4565 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/maxpool.jpeg" alt="maxpool" width="449" height="210" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&amp;resize=449%2C210#038;h=210 449w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=150&amp;h=70 150w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=300&amp;h=140 300w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=768&amp;h=359 768w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg 787w" data-recalc-dims="1" data-lazy-sizes="(max-width: 449px) 100vw, 449px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&amp;is-pending-load=1#038;resize=449%2C210#038;h=210" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" data-attachment-id="4565" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/maxpool/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&#038;resize=449%2C210#038;h=210" data-orig-size="787,368" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"1"}" data-image-title="maxpool" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&#038;resize=449%2C210#038;h=210?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&#038;resize=449%2C210#038;h=210?w=787" class="  wp-image-4565 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&#038;resize=449%2C210#038;h=210" alt="maxpool" width="449" height="210" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=449&#038;resize=449%2C210#038;h=210 449w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=150&#038;h=70 150w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=300&#038;h=140 300w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg?w=768&#038;h=359 768w, https://poissonisfish.files.wordpress.com/2018/07/maxpool.jpeg 787w" sizes="(max-width: 449px) 100vw, 449px" data-recalc-dims="1" /></noscript><figcaption class="wp-caption-text">Example of pooling [<a href="https://cs231n.github.io/convolutional-networks/" rel="nofollow" target="_blank">source</a>]</figcaption></figure>
<h3>Flattening</h3>
<p>Flattening, as the name suggest, simply converts the last convolutional layer into a one-dimensional NN layer. It sets the stage for the actual predictions.</p>
<p>All of the principles discussed regarding NNs (i.e. weights, activation, loss, optimization, backprogagation, batch size and regularization) apply to CNNs as well.</p>
<h1>Let’s get started with R</h1>
<p style="text-align:left;">First, you will need to install the Keras package and the TensorFlow dependency. Please follow the installation instructions <a href="https://keras.rstudio.com/" rel="nofollow" target="_blank">here</a>. If you are using NVIDIA cards, you might want to customise the installation with the command&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-m0">install_keras</span><span class="enlighter-g1">()</span></span></div><code class="enlighter-origin">install_keras()</code>&nbsp;and tap into the power of CUDAs. The default installation is CPU-based.</p>
<h2>Downloading Dogs vs. Cats</h2>
<p style="text-align:left;">The Kaggle API was recently developed to facilitate a fast, programatic access to datasets and competitions. To use the Kaggle API please register to Kaggle, create your <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">kaggle.</span><span class="enlighter-m3">json</span></span></div><code class="enlighter-origin">kaggle.json</code> token and accept the rules from the Dogs vs. Cats competition, as indicated in the&nbsp;<a href="https://github.com/Kaggle/kaggle-api" rel="nofollow" target="_blank">GitHub page</a>.</p>
<p style="text-align:left;">Using the terminal shell in RStudio, I suggest creating a folder&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">originalData</span></span></div><code class="enlighter-origin">originalData</code>&nbsp;in your working directory, and then using the Kaggle API to store all contents associated with the competition therein.&nbsp;If you prefer using your web browser or cannot use a terminal shell, download it directly from the competition page.&nbsp;Finally, unzip the compressed files (i.e. train and test sets) into the working directory.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-overflow-scroll "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">mkdir originalData/</span></div></div><div class=""><div><span class="enlighter-text">kaggle competitions download -c dogs-vs-cats -p originalData/</span></div></div><div class=""><div><span class="enlighter-text">unzip </span><span class="enlighter-s0">'originalData/*.zip'</span></div></div></div><div class="enlighter-raw">mkdir originalData/
kaggle competitions download -c dogs-vs-cats -p originalData/
unzip 'originalData/*.zip'</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="enlighter-origin">mkdir originalData/
kaggle competitions download -c dogs-vs-cats -p originalData/
unzip 'originalData/*.zip'
</pre>
<p style="text-align:left;">You have just populated the working directory with the directories&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">train</span></span></div><code class="enlighter-origin">train</code>&nbsp;and&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">test1</span></span></div><code class="enlighter-origin">test1</code>&nbsp;(besides&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">originalData</span></span></div><code class="enlighter-origin">originalData</code>), each containing 25,000 and 12,500 <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">.jpg</span></span></div><code class="enlighter-origin">.jpg</code>&nbsp;pictures, respectively, of dogs and cats.</p>
<h2 style="text-align:left;">Image processing</h2>
<p style="text-align:left;">Install the libraries listed below if necessary. We will start off by visualizing the second cat from the training dataset directly from RStudio, using the Viewer pane.&nbsp;In case you wonder why the second, take a look into the first. Poor cat.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-overflow-scroll "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-m0">library</span><span class="enlighter-g1">(</span><span class="enlighter-text">keras</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">library</span><span class="enlighter-g1">(</span><span class="enlighter-text">EBImage</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">library</span><span class="enlighter-g1">(</span><span class="enlighter-text">stringr</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">library</span><span class="enlighter-g1">(</span><span class="enlighter-text">pbapply</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">secondCat </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">readImage</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"train/cat.1.jpg"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">display</span><span class="enlighter-g1">(</span><span class="enlighter-text">secondCat</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw">library(keras)
library(EBImage)
library(stringr)
library(pbapply)

secondCat &lt;- readImage("train/cat.1.jpg")
display(secondCat)</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="enlighter-origin">library(keras)
library(EBImage)
library(stringr)
library(pbapply)

secondCat &lt;- readImage("train/cat.1.jpg")
display(secondCat)
</pre>
<p><img data-attachment-id="4495" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/cat-1/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578" data-orig-size="300,280" data-comments-opened="1" data-image-title="cat.1" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578?w=300" class=" size-full wp-image-4495 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/cat-1.jpg" alt="cat.1" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg 300w, https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=150 150w" data-recalc-dims="1" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4495" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/cat-1/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578" data-orig-size="300,280" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="cat.1" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578?w=300" class=" size-full wp-image-4495 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=578" alt="cat.1" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg 300w, https://poissonisfish.files.wordpress.com/2018/07/cat-1.jpg?w=150 150w" sizes="(max-width: 300px) 100vw, 300px"   data-recalc-dims="1" /></noscript></p>
<p style="text-align:left;">At this stage I propose resizing the <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">.jpg</span></span></div><code class="enlighter-origin">.jpg</code>&nbsp;images into 50 x 50 px grayscale images that we can easily manipulate numerically. For this purpose I adapted the <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">extract_feature</span></span></div><code class="enlighter-origin">extract_feature</code> function from <a href="https://rpubs.com/kanedglsk/236125" rel="nofollow" target="_blank">Shikun Li’s</a>&nbsp;image classification tutorial. After resizing, this function additionally flattens images to vectors of length 2500. We can then store the train and test sets as two data frames of size 25,000 x 2500 and 12,500 x 2500, respectively.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-overflow-scroll "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0"># Set image size</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">width </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-n1">50</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">height </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-n1">50</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">extract_feature </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-k1">function</span><span class="enlighter-g1">(</span><span class="enlighter-text">dir_path, width, height, labelsExist = T</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">img_size </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- width </span><span class="enlighter-g0">*</span><span class="enlighter-text"> height</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## List images in path</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">images_names </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- list.</span><span class="enlighter-m3">files</span><span class="enlighter-g1">(</span><span class="enlighter-text">dir_path</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-text">labelsExist</span><span class="enlighter-g1">){</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## Select only cats or dogs images</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">catdog </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">str_extract</span><span class="enlighter-g1">(</span><span class="enlighter-text">images_names, </span><span class="enlighter-s0">"^(cat|dog)"</span><span class="enlighter-g1">)</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0"># Set cat == 0 and dog == 1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">key </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">c</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"cat"</span><span class="enlighter-text"> = </span><span class="enlighter-n1">0</span><span class="enlighter-text">, </span><span class="enlighter-s0">"dog"</span><span class="enlighter-text"> = </span><span class="enlighter-n1">1</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">y </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- key</span><span class="enlighter-g1">[</span><span class="enlighter-text">catdog</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">print</span><span class="enlighter-g1">(</span><span class="enlighter-m0">paste</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"Start processing"</span><span class="enlighter-text">, </span><span class="enlighter-m0">length</span><span class="enlighter-g1">(</span><span class="enlighter-text">images_names</span><span class="enlighter-g1">)</span><span class="enlighter-text">, </span><span class="enlighter-s0">"images"</span><span class="enlighter-g1">))</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## This function will resize an image, turn it into greyscale</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">feature_list </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">pblapply</span><span class="enlighter-g1">(</span><span class="enlighter-text">images_names, </span><span class="enlighter-k1">function</span><span class="enlighter-g1">(</span><span class="enlighter-text">imgname</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">{</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## Read image</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">img </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">readImage</span><span class="enlighter-g1">(</span><span class="enlighter-text">file.</span><span class="enlighter-m3">path</span><span class="enlighter-g1">(</span><span class="enlighter-text">dir_path, imgname</span><span class="enlighter-g1">))</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## Resize image</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">img_resized </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">resize</span><span class="enlighter-g1">(</span><span class="enlighter-text">img, w = width, h = height</span><span class="enlighter-g1">)</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## Set to grayscale (normalized to max)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">grayimg </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">channel</span><span class="enlighter-g1">(</span><span class="enlighter-text">img_resized, </span><span class="enlighter-s0">"gray"</span><span class="enlighter-g1">)</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## Get the image as a matrix</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">img_matrix </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- grayimg@.Data</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## Coerce to a vector (row-wise)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">img_vector </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- as.</span><span class="enlighter-m3">vector</span><span class="enlighter-g1">(</span><span class="enlighter-m0">t</span><span class="enlighter-g1">(</span><span class="enlighter-text">img_matrix</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">return</span><span class="enlighter-g1">(</span><span class="enlighter-text">img_vector</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">})</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## bind the list of vector into matrix</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">feature_matrix </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-k1">do</span><span class="enlighter-text">.</span><span class="enlighter-m3">call</span><span class="enlighter-g1">(</span><span class="enlighter-text">rbind, feature_list</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">feature_matrix </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- as.</span><span class="enlighter-m3">data</span><span class="enlighter-text">.</span><span class="enlighter-m3">frame</span><span class="enlighter-g1">(</span><span class="enlighter-text">feature_matrix</span><span class="enlighter-g1">)</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0">## Set names</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">names</span><span class="enlighter-g1">(</span><span class="enlighter-text">feature_matrix</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">paste0</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"pixel"</span><span class="enlighter-text">, </span><span class="enlighter-m0">c</span><span class="enlighter-g1">(</span><span class="enlighter-n1">1</span><span class="enlighter-text">:img_size</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">if</span><span class="enlighter-g1">(</span><span class="enlighter-text">labelsExist</span><span class="enlighter-g1">){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">return</span><span class="enlighter-g1">(</span><span class="enlighter-m0">list</span><span class="enlighter-g1">(</span><span class="enlighter-text">X = feature_matrix, y = y</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-k1">else</span><span class="enlighter-g1">{</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">return</span><span class="enlighter-g1">(</span><span class="enlighter-text">feature_matrix</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span></div></div></div><div class="enlighter-raw"># Set image size
width &lt;- 50
height &lt;- 50

extract_feature &lt;- function(dir_path, width, height, labelsExist = T) {
img_size &lt;- width * height

## List images in path
images_names &lt;- list.files(dir_path)

if(labelsExist){
## Select only cats or dogs images
catdog &lt;- str_extract(images_names, "^(cat|dog)")
# Set cat == 0 and dog == 1
key &lt;- c("cat" = 0, "dog" = 1)
y &lt;- key[catdog]
}

print(paste("Start processing", length(images_names), "images"))
## This function will resize an image, turn it into greyscale
feature_list &lt;- pblapply(images_names, function(imgname) {
## Read image
img &lt;- readImage(file.path(dir_path, imgname))
## Resize image
img_resized &lt;- resize(img, w = width, h = height)
## Set to grayscale (normalized to max)
grayimg &lt;- channel(img_resized, "gray")
## Get the image as a matrix
img_matrix &lt;- grayimg@.Data
## Coerce to a vector (row-wise)
img_vector &lt;- as.vector(t(img_matrix))
return(img_vector)
})
## bind the list of vector into matrix
feature_matrix &lt;- do.call(rbind, feature_list)
feature_matrix &lt;- as.data.frame(feature_matrix)
## Set names
names(feature_matrix) &lt;- paste0("pixel", c(1:img_size))

if(labelsExist){
return(list(X = feature_matrix, y = y))
}else{
return(feature_matrix)
}
}</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="enlighter-origin"># Set image size
width &lt;- 50
height &lt;- 50

extract_feature &lt;- function(dir_path, width, height, labelsExist = T) {
img_size &lt;- width * height

## List images in path
images_names &lt;- list.files(dir_path)

if(labelsExist){
## Select only cats or dogs images
catdog &lt;- str_extract(images_names, "^(cat|dog)")
# Set cat == 0 and dog == 1
key &lt;- c("cat" = 0, "dog" = 1)
y &lt;- key[catdog]
}

print(paste("Start processing", length(images_names), "images"))
## This function will resize an image, turn it into greyscale
feature_list &lt;- pblapply(images_names, function(imgname) {
## Read image
img &lt;- readImage(file.path(dir_path, imgname))
## Resize image
img_resized &lt;- resize(img, w = width, h = height)
## Set to grayscale (normalized to max)
grayimg &lt;- channel(img_resized, "gray")
## Get the image as a matrix
img_matrix &lt;- grayimg@.Data
## Coerce to a vector (row-wise)
img_vector &lt;- as.vector(t(img_matrix))
return(img_vector)
})
## bind the list of vector into matrix
feature_matrix &lt;- do.call(rbind, feature_list)
feature_matrix &lt;- as.data.frame(feature_matrix)
## Set names
names(feature_matrix) &lt;- paste0("pixel", c(1:img_size))

if(labelsExist){
return(list(X = feature_matrix, y = y))
}else{
return(feature_matrix)
}
}
</pre>
<p style="text-align:left;">Next, we use the function to process both datasets by passing their corresponding directories. This should take about 20-30 minutes.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-overflow-scroll "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0"># Takes approx. 15min</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">trainData </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">extract_feature</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"train/"</span><span class="enlighter-text">, width, height</span><span class="enlighter-g1">)</span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0"># Takes slightly less</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">testData </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">extract_feature</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"test1/"</span><span class="enlighter-text">, width, height, labelsExist = F</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw"># Takes approx. 15min
trainData &lt;- extract_feature("train/", width, height)
# Takes slightly less
testData &lt;- extract_feature("test1/", width, height, labelsExist = F)</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="enlighter-origin"># Takes approx. 15min
trainData &lt;- extract_feature("train/", width, height)
# Takes slightly less
testData &lt;- extract_feature("test1/", width, height, labelsExist = F)
</pre>
<p style="text-align:left;">Let’s look at how the transformation worked on the second cat and store the two data frames in a single R object.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-overflow-scroll "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0"># Check processing on second cat</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">par</span><span class="enlighter-g1">(</span><span class="enlighter-text">mar = </span><span class="enlighter-m0">rep</span><span class="enlighter-g1">(</span><span class="enlighter-n1">0</span><span class="enlighter-text">, </span><span class="enlighter-n1">4</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">testCat </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">t</span><span class="enlighter-g1">(</span><span class="enlighter-m0">matrix</span><span class="enlighter-g1">(</span><span class="enlighter-text">as.</span><span class="enlighter-m3">numeric</span><span class="enlighter-g1">(</span><span class="enlighter-text">trainData$X</span><span class="enlighter-g1">[</span><span class="enlighter-n1">2</span><span class="enlighter-text">,</span><span class="enlighter-g1">])</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">nrow = width, ncol = height, T</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">image</span><span class="enlighter-g1">(</span><span class="enlighter-m0">t</span><span class="enlighter-g1">(</span><span class="enlighter-m0">apply</span><span class="enlighter-g1">(</span><span class="enlighter-text">testCat, </span><span class="enlighter-n1">2</span><span class="enlighter-text">, rev</span><span class="enlighter-g1">))</span><span class="enlighter-text">, col = gray.</span><span class="enlighter-m3">colors</span><span class="enlighter-g1">(</span><span class="enlighter-n1">12</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">axes = F</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0"># Save</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">save</span><span class="enlighter-g1">(</span><span class="enlighter-text">trainData, testData, file = </span><span class="enlighter-s0">"catdogData.RData"</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw"># Check processing on second cat
par(mar = rep(0, 4))
testCat &lt;- t(matrix(as.numeric(trainData$X[2,]),
nrow = width, ncol = height, T))
image(t(apply(testCat, 2, rev)), col = gray.colors(12),
axes = F)

# Save
save(trainData, testData, file = "catdogData.RData")</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="enlighter-origin"># Check processing on second cat
par(mar = rep(0, 4))
testCat &lt;- t(matrix(as.numeric(trainData$X[2,]),
nrow = width, ncol = height, T))
image(t(apply(testCat, 2, rev)), col = gray.colors(12),
axes = F)

# Save
save(trainData, testData, file = "catdogData.RData")
</pre>
<h2><img data-attachment-id="4494" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/example/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578" data-orig-size="300,300" data-comments-opened="1" data-image-title="example" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578?w=300" class=" size-full wp-image-4494 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/example1.jpeg" alt="example" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg 300w, https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=150 150w" data-recalc-dims="1" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4494" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/example/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578" data-orig-size="300,300" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="example" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578?w=300" class=" size-full wp-image-4494 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=578" alt="example" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg 300w, https://poissonisfish.files.wordpress.com/2018/07/example1.jpeg?w=150 150w" sizes="(max-width: 300px) 100vw, 300px"   data-recalc-dims="1" /></noscript></h2>
<p>We can confidently&nbsp;say any person could identify a cat in this particular instance. It is not always going to be the case, considering some images in both sets are ambiguous. Not only that, the downsizing to 50 x 50 px will inevitably complicate the recognition task.</p>
<h2>Training and validation</h2>
<p style="text-align:left;">The network structure was inspired from the&nbsp;<a href="https://github.com/keras-team/keras/blob/master/examples/cifar10_cnn.py" rel="nofollow" target="_blank">CIFAR10 CNN example</a> in the Keras GitHub page. We first need to rearrange the train and test data frames into 4D tensors / arrays of shape 25000 x 50 x 50 x 1 (i.e. observations x height x width x channels). The binary classifier we are about to construct will have a single-unit output layer with sigmoid activation. As a result, and&nbsp;because we encoded cats and dogs as 0 and 1, respectively, it will retrieve the probability of dog, <img src="./Ejemplo_RBloggers_files/latex(6).php" alt="P(y = Dog) " title="P(y = Dog) " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="P(y = Dog) " title="P(y = Dog) " class="latex" /></noscript>. The Keras training framework&nbsp;has three main stages:&nbsp;<em>i</em>) one to specify the architecture, <em>ii</em>) one to compile the model by selecting the loss function, the optimizer and metrics of goodness-of-fit, and finally <em>iii</em>) one to fit the model by determining the number of epochs, batch size and validation split. If you are familiar with Python-based Keras, you will notice the R syntax becomes very similar with the usage of the pipe operator <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">%</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">%</span></span></div><code class="enlighter-origin">%&gt;%</code>&nbsp;from the <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">magrittr</span></span></div><code class="enlighter-origin">magrittr</code> package. Here is the proposed CNN architecture.</p>
<p><img data-attachment-id="4631" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/slide1/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578" data-orig-size="720,540" data-comments-opened="1" data-image-title="Slide1" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578?w=720" class="alignnone size-full wp-image-4631 jetpack-lazy-image" src="./Ejemplo_RBloggers_files/slide1.jpg" alt="Slide1" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg 720w, https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=300 300w" data-recalc-dims="1" data-lazy-sizes="(max-width: 720px) 100vw, 720px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4631" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/slide1/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578" data-orig-size="720,540" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="Slide1" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578?w=720" class="alignnone size-full wp-image-4631" src="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=578" alt="Slide1" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg 720w, https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/slide1.jpg?w=300 300w" sizes="(max-width: 720px) 100vw, 720px"   data-recalc-dims="1" /></noscript></p>
<p>Setting padding to ‘same’ maintains the original size, adding as many layers of zeros around the borders as determined by the kernel size, whereas to ‘valid’ does not introduce padding and thus reduces size. The following code will rearrange the 4D tensors, define the model and train it. For the next 1-2 hours you will be able to monitor accuracy and loss on a hold-out sample (20%) of the training set.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-overflow-scroll "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0"># Fix structure for 2d CNN</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">train_array %</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">layer_dropout</span><span class="enlighter-g1">(</span><span class="enlighter-text">rate = </span><span class="enlighter-n0">0.25</span><span class="enlighter-g1">)</span><span class="enlighter-text"> %</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">%</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">layer_flatten</span><span class="enlighter-g1">()</span><span class="enlighter-text"> %</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">%</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">layer_dense</span><span class="enlighter-g1">(</span><span class="enlighter-text">units = </span><span class="enlighter-n1">50</span><span class="enlighter-text">, activation = </span><span class="enlighter-s0">"relu"</span><span class="enlighter-g1">)</span><span class="enlighter-text"> %</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">%</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">layer_dropout</span><span class="enlighter-g1">(</span><span class="enlighter-text">rate = </span><span class="enlighter-n0">0.25</span><span class="enlighter-g1">)</span><span class="enlighter-text"> %</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">%</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">layer_dense</span><span class="enlighter-g1">(</span><span class="enlighter-text">units = </span><span class="enlighter-n1">1</span><span class="enlighter-text">, activation = </span><span class="enlighter-s0">"sigmoid"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">summary</span><span class="enlighter-g1">(</span><span class="enlighter-text">model</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">model %</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">% </span><span class="enlighter-m0">compile</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">loss = </span><span class="enlighter-s0">'binary_crossentropy'</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">optimizer = </span><span class="enlighter-s0">"adam"</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">metrics = </span><span class="enlighter-m0">c</span><span class="enlighter-g1">(</span><span class="enlighter-s0">'accuracy'</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">history % </span><span class="enlighter-m0">fit</span><span class="enlighter-g1">(</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">x = train_array, y = as.</span><span class="enlighter-m3">numeric</span><span class="enlighter-g1">(</span><span class="enlighter-text">trainData$y</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">epochs = </span><span class="enlighter-n1">30</span><span class="enlighter-text">, batch_size = </span><span class="enlighter-n1">100</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">validation_split = </span><span class="enlighter-n0">0.2</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">plot</span><span class="enlighter-g1">(</span><span class="enlighter-text">history</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw"># Fix structure for 2d CNN
train_array %
layer_dropout(rate = 0.25) %&gt;%

layer_flatten() %&gt;%
layer_dense(units = 50, activation = "relu") %&gt;%
layer_dropout(rate = 0.25) %&gt;%
layer_dense(units = 1, activation = "sigmoid")

summary(model)

model %&gt;% compile(
loss = 'binary_crossentropy',
optimizer = "adam",
metrics = c('accuracy')
)

history % fit(
x = train_array, y = as.numeric(trainData$y),
epochs = 30, batch_size = 100,
validation_split = 0.2
)

plot(history)</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="enlighter-origin"># Fix structure for 2d CNN
train_array %
layer_dropout(rate = 0.25) %&gt;%

layer_flatten() %&gt;%
layer_dense(units = 50, activation = "relu") %&gt;%
layer_dropout(rate = 0.25) %&gt;%
layer_dense(units = 1, activation = "sigmoid")

summary(model)

model %&gt;% compile(
loss = 'binary_crossentropy',
optimizer = "adam",
metrics = c('accuracy')
)

history % fit(
x = train_array, y = as.numeric(trainData$y),
epochs = 30, batch_size = 100,
validation_split = 0.2
)

plot(history)
</pre>
<p><img data-attachment-id="4477" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/acc/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578" data-orig-size="700,300" data-comments-opened="1" data-image-title="acc" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578?w=700" class=" size-full wp-image-4477 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/acc.jpeg" alt="acc" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg 700w, https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=300 300w" data-recalc-dims="1" data-lazy-sizes="(max-width: 700px) 100vw, 700px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4477" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/acc/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578" data-orig-size="700,300" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="acc" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578?w=700" class=" size-full wp-image-4477 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=578" alt="acc" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg 700w, https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/acc.jpeg?w=300 300w" sizes="(max-width: 700px) 100vw, 700px"   data-recalc-dims="1" /></noscript></p>
<p style="text-align:left;">Your results should look like this. As the model trains epoch after epoch, cross-entropy (‘loss’) is minimized in both training and validation splits. The apparent increase in the validation split after the 20th epoch is suggestive of slight overfitting. Accuracy, inversely proportional to cross-entropy, stalls at around 95% and 75% in training and validation splits, respectively. Pretty decent results on the fly.</p>
<p style="text-align:left;">Let’s now investigate the performance on the test set. Recall we have no known labels for the 12,500 photographs that comprise the test set. Therefore, I propose taking 32 random images from the entire test set and visually inspect the predictions – classes and associated probabilities. Finally, we can store the model as a R object for future predictions.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-hover enlighter-overflow-scroll "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw" title="Plain text"></div><div class="enlighter-btn enlighter-btn-copy" title="Copy to clipboard"></div><div class="enlighter-btn enlighter-btn-window" title="Open code in new window"></div><div class="enlighter-btn enlighter-btn-website" title="EnlighterJS 3 Syntax Highlighter"></div></div><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0"># Compute probabilities and predictions on test set</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">predictions </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">-  </span><span class="enlighter-m0">predict_classes</span><span class="enlighter-g1">(</span><span class="enlighter-text">model, test_array</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">probabilities </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">predict_proba</span><span class="enlighter-g1">(</span><span class="enlighter-text">model, test_array</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0"># Visual inspection of 32 cases</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">set.</span><span class="enlighter-m3">seed</span><span class="enlighter-g1">(</span><span class="enlighter-n1">100</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">random </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- </span><span class="enlighter-m0">sample</span><span class="enlighter-g1">(</span><span class="enlighter-n1">1</span><span class="enlighter-text">:</span><span class="enlighter-m0">nrow</span><span class="enlighter-g1">(</span><span class="enlighter-text">testData</span><span class="enlighter-g1">)</span><span class="enlighter-text">, </span><span class="enlighter-n1">32</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">preds </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- predictions</span><span class="enlighter-g1">[</span><span class="enlighter-text">random,</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">probs </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">- as.</span><span class="enlighter-m3">vector</span><span class="enlighter-g1">(</span><span class="enlighter-m0">round</span><span class="enlighter-g1">(</span><span class="enlighter-text">probabilities</span><span class="enlighter-g1">[</span><span class="enlighter-text">random,</span><span class="enlighter-g1">]</span><span class="enlighter-text">, </span><span class="enlighter-n1">2</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">par</span><span class="enlighter-g1">(</span><span class="enlighter-text">mfrow = </span><span class="enlighter-m0">c</span><span class="enlighter-g1">(</span><span class="enlighter-n1">4</span><span class="enlighter-text">, </span><span class="enlighter-n1">8</span><span class="enlighter-g1">)</span><span class="enlighter-text">, mar = </span><span class="enlighter-m0">rep</span><span class="enlighter-g1">(</span><span class="enlighter-n1">0</span><span class="enlighter-text">, </span><span class="enlighter-n1">4</span><span class="enlighter-g1">))</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-k1">for</span><span class="enlighter-g1">(</span><span class="enlighter-text">i </span><span class="enlighter-k1">in</span><span class="enlighter-text"> </span><span class="enlighter-n1">1</span><span class="enlighter-text">:</span><span class="enlighter-m0">length</span><span class="enlighter-g1">(</span><span class="enlighter-text">random</span><span class="enlighter-g1">)){</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">image</span><span class="enlighter-g1">(</span><span class="enlighter-m0">t</span><span class="enlighter-g1">(</span><span class="enlighter-m0">apply</span><span class="enlighter-g1">(</span><span class="enlighter-text">test_array</span><span class="enlighter-g1">[</span><span class="enlighter-text">random</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">,,,</span><span class="enlighter-g1">]</span><span class="enlighter-text">, </span><span class="enlighter-n1">2</span><span class="enlighter-text">, rev</span><span class="enlighter-g1">))</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">col = gray.</span><span class="enlighter-m3">colors</span><span class="enlighter-g1">(</span><span class="enlighter-n1">12</span><span class="enlighter-g1">)</span><span class="enlighter-text">, axes = F</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">legend</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"topright"</span><span class="enlighter-text">, legend = </span><span class="enlighter-m0">ifelse</span><span class="enlighter-g1">(</span><span class="enlighter-text">preds</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-n1">0</span><span class="enlighter-text">, </span><span class="enlighter-s0">"Cat"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"Dog"</span><span class="enlighter-g1">)</span><span class="enlighter-text">,</span></div></div><div class=""><div><span class="enlighter-text">text.</span><span class="enlighter-m3">col</span><span class="enlighter-text"> = </span><span class="enlighter-m0">ifelse</span><span class="enlighter-g1">(</span><span class="enlighter-text">preds</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text"> == </span><span class="enlighter-n1">0</span><span class="enlighter-text">, </span><span class="enlighter-n1">2</span><span class="enlighter-text">, </span><span class="enlighter-n1">4</span><span class="enlighter-g1">)</span><span class="enlighter-text">, bty = </span><span class="enlighter-s0">"n"</span><span class="enlighter-text">, text.</span><span class="enlighter-m3">font</span><span class="enlighter-text"> = </span><span class="enlighter-n1">2</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">legend</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"topleft"</span><span class="enlighter-text">, legend = probs</span><span class="enlighter-g1">[</span><span class="enlighter-text">i</span><span class="enlighter-g1">]</span><span class="enlighter-text">, bty = </span><span class="enlighter-s0">"n"</span><span class="enlighter-text">, col = </span><span class="enlighter-s0">"white"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">}</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0"></span></div></div><div class=""><div><span class="enlighter-c0"># Save model</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">save</span><span class="enlighter-g1">(</span><span class="enlighter-text">model, file = </span><span class="enlighter-s0">"CNNmodel.RData"</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw"># Compute probabilities and predictions on test set
predictions &lt;-  predict_classes(model, test_array)
probabilities &lt;- predict_proba(model, test_array)

# Visual inspection of 32 cases
set.seed(100)
random &lt;- sample(1:nrow(testData), 32)
preds &lt;- predictions[random,]
probs &lt;- as.vector(round(probabilities[random,], 2))

par(mfrow = c(4, 8), mar = rep(0, 4))
for(i in 1:length(random)){
image(t(apply(test_array[random[i],,,], 2, rev)),
col = gray.colors(12), axes = F)
legend("topright", legend = ifelse(preds[i] == 0, "Cat", "Dog"),
text.col = ifelse(preds[i] == 0, 2, 4), bty = "n", text.font = 2)
legend("topleft", legend = probs[i], bty = "n", col = "white")
}

# Save model
save(model, file = "CNNmodel.RData")</div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="enlighter-origin"># Compute probabilities and predictions on test set
predictions &lt;-  predict_classes(model, test_array)
probabilities &lt;- predict_proba(model, test_array)

# Visual inspection of 32 cases
set.seed(100)
random &lt;- sample(1:nrow(testData), 32)
preds &lt;- predictions[random,]
probs &lt;- as.vector(round(probabilities[random,], 2))

par(mfrow = c(4, 8), mar = rep(0, 4))
for(i in 1:length(random)){
image(t(apply(test_array[random[i],,,], 2, rev)),
col = gray.colors(12), axes = F)
legend("topright", legend = ifelse(preds[i] == 0, "Cat", "Dog"),
text.col = ifelse(preds[i] == 0, 2, 4), bty = "n", text.font = 2)
legend("topleft", legend = probs[i], bty = "n", col = "white")
}

# Save model
save(model, file = "CNNmodel.RData")
</pre>
<p><img loading="lazy" data-attachment-id="4483" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/val/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450#038;h=347" data-orig-size="600,300" data-comments-opened="1" data-image-title="val" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450#038;h=347?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450#038;h=347?w=600" class="  wp-image-4483 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/val3.jpeg" alt="val" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg 600w, https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=150&amp;h=75 150w, https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=300&amp;h=150 300w" data-recalc-dims="1" data-lazy-sizes="(max-width: 694px) 100vw, 694px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450&amp;is-pending-load=1#038;h=347" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" data-attachment-id="4483" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/val/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450#038;h=347" data-orig-size="600,300" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="val" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450#038;h=347?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450#038;h=347?w=600" class="  wp-image-4483 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=450#038;h=347" alt="val" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg 600w, https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=150&#038;h=75 150w, https://poissonisfish.files.wordpress.com/2018/07/val3.jpeg?w=300&#038;h=150 300w" sizes="(max-width: 694px) 100vw, 694px" data-recalc-dims="1" /></noscript></p>
<p style="text-align:left;">Noteworthy, many of the misclassifications depicted above are associated with <img src="./Ejemplo_RBloggers_files/latex(7).php" alt="P(y = Dog) \approx 0.50" title="P(y = Dog) \approx 0.50" class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+%5Capprox+0.50&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+%5Capprox+0.50&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="P(y = Dog) \approx 0.50" title="P(y = Dog) \approx 0.50" class="latex" /></noscript>, at with uncertainty is maximum. We could take advantage of this and introduce a ‘grey zone’ in the prediction, for instance, by predicting dogs with&nbsp;<img src="./Ejemplo_RBloggers_files/latex(8).php" alt="P(y = Dog) \geqslant 0.75 " title="P(y = Dog) \geqslant 0.75 " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+%5Cgeqslant%C2%A00.75+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+%5Cgeqslant%C2%A00.75+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="P(y = Dog) \geqslant 0.75 " title="P(y = Dog) \geqslant 0.75 " class="latex" /></noscript> and cats with&nbsp;<img src="./Ejemplo_RBloggers_files/latex(9).php" alt="P(y = Dog) \leqslant 0.25 " title="P(y = Dog) \leqslant 0.25 " class="latex jetpack-lazy-image" data-lazy-src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+%5Cleqslant+0.25+&amp;is-pending-load=1#038;bg=f9f9f9&amp;%23038;fg=555555&amp;%23038;s=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img src="https://s0.wp.com/latex.php?latex=P%28y+%3D+Dog%29+%5Cleqslant+0.25+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1" alt="P(y = Dog) \leqslant 0.25 " title="P(y = Dog) \leqslant 0.25 " class="latex" /></noscript>, while dismissing all other cases. Again, something worth covering in a future tutorial.</p>
<p style="text-align:left;">I was really curious to test this CNN with my own two pets, Pitti &amp; Platsch, so I decided to give it a go.</p>
<figure data-shortcode="caption" id="attachment_4508" style="width: 2095px" class="wp-caption aligncenter"><img data-attachment-id="4508" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/drawing/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578" data-orig-size="2095,939" data-comments-opened="1" data-image-title="drawing" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578?w=1024" class="alignnone size-full wp-image-4508 jetpack-lazy-image" src="./Ejemplo_RBloggers_files/drawing-e1531154540457.png" alt="drawing-e1531153149563.png" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578 1108w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=300 300w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=768 768w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=1024 1024w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png 2095w" data-recalc-dims="1" data-lazy-sizes="(max-width: 1108px) 100vw, 1108px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4508" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/drawing/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578" data-orig-size="2095,939" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="drawing" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578?w=1024" class="alignnone size-full wp-image-4508" src="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578" alt="drawing-e1531153149563.png" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=578 1108w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=300 300w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=768 768w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png?w=1024 1024w, https://poissonisfish.files.wordpress.com/2018/07/drawing-e1531154540457.png 2095w" sizes="(max-width: 1108px) 100vw, 1108px"   data-recalc-dims="1" /></noscript><figcaption class="wp-caption-text">The half-sibs Princess Pitti (left) and Prince Platsch (right).</figcaption></figure>
<p style="text-align:left;">I simply transformed their pictures above and ran&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">predict_classes</span></span></div><code class="enlighter-origin">predict_classes</code>&nbsp;and&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter "><span class="enlighter"><span class="enlighter-text">predict_proba</span></span></div><code class="enlighter-origin">predict_proba</code>&nbsp;to determine the two predictions and associated probabilities, respectively. For my relief, the model identified both my pets as cats with relatively high certainty.</p>
<p><img data-attachment-id="4488" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/pittiplutsch/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578" data-orig-size="600,300" data-comments-opened="1" data-image-title="pittiplutsch" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578?w=600" class=" size-full wp-image-4488 aligncenter jetpack-lazy-image" src="./Ejemplo_RBloggers_files/pittiplutsch.jpeg" alt="pittiplutsch" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg 600w, https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=300 300w" data-recalc-dims="1" data-lazy-sizes="(max-width: 600px) 100vw, 600px" data-lazy-src="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="4488" data-permalink="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/pittiplutsch/" data-orig-file="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578" data-orig-size="600,300" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="pittiplutsch" data-image-description="" data-medium-file="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578?w=300" data-large-file="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578?w=600" class=" size-full wp-image-4488 aligncenter" src="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=578" alt="pittiplutsch" srcset_temp="https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg 600w, https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=150 150w, https://poissonisfish.files.wordpress.com/2018/07/pittiplutsch.jpeg?w=300 300w" sizes="(max-width: 600px) 100vw, 600px"   data-recalc-dims="1" /></noscript></p>
<h2 style="text-align:left;">Wrap-up</h2>
<p style="text-align:left;">I hope you gained a basic understanding of CNNs and how to implement them using the Keras R interface in virtually any machine. I think this was a fun experiment that yielded a fairly good CNN model, being able to distinguish cats and dogs approximatelly 75% of the time, considering our frugal input setup.</p>
<p>We could still set the bar higher. We could try boosting the validation accuracy using inputs larger than 50 x 50 px, RGB color channels (in which case the model inputs would be 4D tensors of shape 25000 x 50 x 50 x 3) and more elaborate architectures. I am afraid, however, that a substantial improvement will require some good specs.</p>
<p>The Keras R interface can be intimidating for new users, but it is certainly a good starting point for the emerging deep learning enthusiasts, myself included.</p>
<p>Finally, I am earnestly counting on your feedback for improvements, specially concerning clarity and any non-sense I might have written. Please, comment below or contact me directly. I also want to thank my beloved <a href="https://www.bel-voyage.com/" rel="nofollow" target="_blank">Isabel</a> for reviewing my longest post ever.</p>
<p>Now, if you will excuse me, I have to feed and clean after my masters.</p>

<script type="text/javascript">
    var vglnk = {key: '949efb41171ac6ec1bf7f206d57e90b8'};
    (function(d, t) {
        var s = d.createElement(t);
            s.type = 'text/javascript';
            s.async = true;
			// s.defer = true;
//          s.src = '//cdn.viglink.com/api/vglnk.js'; 
			s.src = 'https://www.r-bloggers.com/wp-content/uploads/2020/08/vglnk.js';
        var r = d.getElementsByTagName(t)[0];
            r.parentNode.insertBefore(s, r);
    }(document, 'script'));
</script>
		
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-visual jp-relatedposts-grid "><div class="jp-relatedposts-post jp-relatedposts-post0 jp-relatedposts-post-nothumbs" data-post-id="175534" data-post-format="false"><a class="jp-relatedposts-post-a jp-relatedposts-post-aoverlay" href="https://www.r-bloggers.com/2019/01/how-do-convolutional-neural-nets-cnns-learn-keras-example/" title="How do Convolutional Neural Nets (CNNs) learn? + Keras example

As with the other videos from our codecentric.ai Bootcamp (Random Forests, Neural Nets &amp; Gradient Boosting), I am again sharing an English version of the script (plus R code) for this most recent addition on How Convolutional Neural Nets work. In this lesson, I am going to explain how computers…" rel="nofollow" data-origin="164887" data-position="0"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/2019/01/how-do-convolutional-neural-nets-cnns-learn-keras-example/" title="How do Convolutional Neural Nets (CNNs) learn? + Keras example

As with the other videos from our codecentric.ai Bootcamp (Random Forests, Neural Nets &amp; Gradient Boosting), I am again sharing an English version of the script (plus R code) for this most recent addition on How Convolutional Neural Nets work. In this lesson, I am going to explain how computers…" rel="nofollow" data-origin="164887" data-position="0">How do Convolutional Neural Nets (CNNs) learn? + Keras example</a></h4><p class="jp-relatedposts-post-excerpt" style="max-height: 7.14286em;">As with the other videos from our codecentric.ai Bootcamp (Random Forests, Neural Nets &amp; Gradient Boosting), I am again sharing an English version of the script (plus R code) for this most recent addition on How Convolutional Neural Nets work. In this lesson, I am going to explain how computers…</p><p class="jp-relatedposts-post-date" style="display: block;">January 8, 2019</p><p class="jp-relatedposts-post-context">In "R bloggers"</p></div><div class="jp-relatedposts-post jp-relatedposts-post1 jp-relatedposts-post-nothumbs" data-post-id="198654" data-post-format="false"><a class="jp-relatedposts-post-a jp-relatedposts-post-aoverlay" href="https://www.r-bloggers.com/2020/02/convolutional-neural-network-under-the-hood-2/" title="Convolutional Neural Network under the Hood

Neural networks have really taken over for solving image recognition and high sample rate data problems in the last couple of years. In all honesty, I promise I won’t be teaching you what neural networks are or CNN’s are. There are hundred’s of resources that are published everyday explaining them.…" rel="nofollow" data-origin="164887" data-position="1"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/2020/02/convolutional-neural-network-under-the-hood-2/" title="Convolutional Neural Network under the Hood

Neural networks have really taken over for solving image recognition and high sample rate data problems in the last couple of years. In all honesty, I promise I won’t be teaching you what neural networks are or CNN’s are. There are hundred’s of resources that are published everyday explaining them.…" rel="nofollow" data-origin="164887" data-position="1">Convolutional Neural Network under the Hood</a></h4><p class="jp-relatedposts-post-excerpt" style="max-height: 7.14286em;">Neural networks have really taken over for solving image recognition and high sample rate data problems in the last couple of years. In all honesty, I promise I won’t be teaching you what neural networks are or CNN’s are. There are hundred’s of resources that are published everyday explaining them.…</p><p class="jp-relatedposts-post-date" style="display: block;">February 27, 2020</p><p class="jp-relatedposts-post-context">In "R bloggers"</p></div><div class="jp-relatedposts-post jp-relatedposts-post2 jp-relatedposts-post-nothumbs" data-post-id="193761" data-post-format="false"><a class="jp-relatedposts-post-a jp-relatedposts-post-aoverlay" href="https://www.r-bloggers.com/2020/02/convolutional-neural-network-under-the-hood/" title="Convolutional Neural Network under the Hood

Neural networks have really taken over for solving image recognition and high sample rate data problems in the last couple of years. In all honesty, I promise I won’t be teaching you what neural networks are or CNN’s are. There are hundred’s of resources that are published everyday explaining them.…" rel="nofollow" data-origin="164887" data-position="2"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/2020/02/convolutional-neural-network-under-the-hood/" title="Convolutional Neural Network under the Hood

Neural networks have really taken over for solving image recognition and high sample rate data problems in the last couple of years. In all honesty, I promise I won’t be teaching you what neural networks are or CNN’s are. There are hundred’s of resources that are published everyday explaining them.…" rel="nofollow" data-origin="164887" data-position="2">Convolutional Neural Network under the Hood</a></h4><p class="jp-relatedposts-post-excerpt" style="max-height: 7.14286em;">Neural networks have really taken over for solving image recognition and high sample rate data problems in the last couple of years. In all honesty, I promise I won’t be teaching you what neural networks are or CNN’s are. There are hundred’s of resources that are published everyday explaining them.…</p><p class="jp-relatedposts-post-date" style="display: block;">February 27, 2020</p><p class="jp-relatedposts-post-context">In "R bloggers"</p></div></div></div><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2F2018%2F07%2Fconvolutional-neural-networks-in-r%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-small mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Convolutional%20Neural%20Networks%20in%20R&amp;url=https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/&amp;via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-small mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.7.7-->
<p class="syndicated-attribution"></p><div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://poissonisfish.wordpress.com/2018/07/08/convolutional-neural-networks-in-r/"> poissonisfish</a></strong>.</div>
<hr>
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="https://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><p></p>			</div>
	</article><nav class="post-navigation clearfix" role="navigation">
<div class="post-nav left">
<a href="https://www.r-bloggers.com/2018/07/establishing-meaningful-performance-comparisons-between-r-and-python/" rel="prev">← Previous post</a></div>
<div class="post-nav right">
<a href="https://www.r-bloggers.com/2018/07/speed-up-your-r-work/" rel="next">Next post →</a></div>
</nav>
	</div>
	<aside class="mh-sidebar sb-right">
	<div id="custom_html-2" class="widget_text sb-widget widget_custom_html"><div class="textwidget custom-html-widget">
<div class="top-search" style="padding-left: 0px;">
	<form id="searchform" action="https://www.google.com/cse" target="_blank">
		<div>
			<input type="hidden" name="cx" value="005359090438081006639:paz69t-s8ua">
			<input type="hidden" name="ie" value="UTF-8">
			<input type="text" value="" name="q" id="q" autocomplete="on" style="font-size:16px;" placeholder="Search R-bloggers..">
			<input type="submit" id="searchsubmit2" name="sa" value="Go" style="font-size:16px;">
		</div>
	<input type="hidden" name="PnM-zH_AKJNfBeFs" value="v*TMZOlu5zynohG6"><input type="hidden" name="-cRxUiIS" value="6UaC7c1T"><input type="hidden" name="VXUxhtONi" value="Nc8akts2n"><input type="hidden" name="GyoDAYLMZ" value="yE2gzT5Zm"></form>

</div>
<!-- thanks: https://stackoverflow.com/questions/14981575/google-cse-with-a-custom-form 
https://stackoverflow.com/questions/10363674/change-size-of-text-in-text-input-tag
--></div></div><div id="text-6" class="sb-widget widget_text">			<div class="textwidget"><div style="min-height:26px;border:1px solid #ccc;padding:3px;text-align:left; background: none repeat scroll 0 0 #FDEADA;">

<form style="width:202px; float:left;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="if (!window.__cfRLUnblockHandlers) return false; window.open(&#39;https://feedburner.google.com/fb/a/mailverify?uri=RBloggers&#39;, &#39;popupwindow&#39;, &#39;scrollbars=yes,width=550,height=520&#39;);return true">

<input type="text" style="width:110px" onclick="if (!window.__cfRLUnblockHandlers) return false; if (this.value == &#39;Your e-mail here&#39;) this.value = &#39;&#39;;" value="Your e-mail here" name="email">
<input type="hidden" value="RBloggers" name="uri"><input type="hidden" name="loc" value="en_US"><input type="submit" value="Subscribe">

<!-- https://feeds.feedburner.com/~fc/RBloggers?bg=99CCFF&amp;fg=444444&amp;anim=0 -->

<input type="hidden" name="PnM-zH_AKJNfBeFs" value="v*TMZOlu5zynohG6"><input type="hidden" name="-cRxUiIS" value="6UaC7c1T"><input type="hidden" name="VXUxhtONi" value="Nc8akts2n"><input type="hidden" name="GyoDAYLMZ" value="yE2gzT5Zm"></form>

<div>
<a href="https://feeds.feedburner.com/RBloggers"><img src="./Ejemplo_RBloggers_files/RBloggers_feedburner_count_2020_07_01-e1593671704447.gif" style="height:17px;min-width:80px;class:skip-lazy;" alt="" data-recalc-dims="1" class="jetpack-lazy-image jetpack-lazy-image--handled" data-lazy-loaded="1"><noscript><img src="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2020/07/RBloggers_feedburner_count_2020_07_01-e1593671704447.gif?w=578&#038;ssl=1" style="height:17px;min-width:80px;class:skip-lazy;" alt="" data-recalc-dims="1" /></noscript></a>
</div>

</div>

<br>

<div>
<script type="text/javascript">
function init() {
var vidDefer = document.getElementsByTagName('iframe');
for (var i=0; i<vidDefer.length; i++) {
if(vidDefer[i].getAttribute('data-src')) {
vidDefer[i].setAttribute('src',vidDefer[i].getAttribute('data-src'));
} } }
window.onload = init;
</script>

<iframe allowtransparency="true" frameborder="0" scrolling="no" src="./Ejemplo_RBloggers_files/follow_button.html" data-src="//platform.twitter.com/widgets/follow_button.html?screen_name=rbloggers&amp;data-show-count" style="width:100%; height:30px;"></iframe>


<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div></div></div>
<script async="" defer="" crossorigin="anonymous" src="./Ejemplo_RBloggers_files/sdk.js(1).descarga" nonce="RysU23SE" type="text/javascript"></script>

<div style="min-height: 154px;" class="fb-page fb_iframe_widget" data-href="https://www.facebook.com/rbloggers/" data-tabs="" data-width="300" data-height="154" data-small-header="true" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true" fb-xfbml-state="rendered" fb-iframe-plugin-query="adapt_container_width=true&amp;app_id=124112670941750&amp;container_width=300&amp;height=154&amp;hide_cover=false&amp;href=https%3A%2F%2Fwww.facebook.com%2Frbloggers%2F&amp;locale=en_GB&amp;sdk=joey&amp;show_facepile=true&amp;small_header=true&amp;tabs=&amp;width=300"><span style="vertical-align: bottom; width: 300px; height: 70px;"><iframe name="fd24709f6c998" width="300px" height="154px" data-testid="fb:page Facebook Social Plugin" title="fb:page Facebook Social Plugin" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" src="./Ejemplo_RBloggers_files/page.html" style="border: none; visibility: visible; width: 300px; height: 70px;" class=""></iframe></span></div>



<!--
<iframe src="" data-src="//www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FR-bloggers%2F191414254890&amp;width=300&amp;height=155&amp;show_faces=true&amp;colorscheme=light&amp;stream=false&amp;border_color&amp;header=false&amp;appId=400430016676958" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100%; height:140px;" allowTransparency="true"></iframe>
-->


<!--
<br/>
<strong>If you are an R blogger yourself</strong> you are invited to <a href="https://www.r-bloggers.com/add-your-blog/">add your own R content feed to this site</a> (<strong>Non-English</strong> R bloggers should add themselves- <a href="https://www.r-bloggers.com/lang/add-your-blog">here</a>) -->

</div></div>
		</div><div id="wppp-3" class="sb-widget widget_wppp"><h4 class="widget-title">Most viewed posts (weekly)</h4>
<ul class="wppp_list">
	<li><a href="https://www.r-bloggers.com/2018/07/pca-vs-autoencoders-for-dimensionality-reduction/" title="PCA vs Autoencoders for Dimensionality Reduction">PCA vs Autoencoders for Dimensionality Reduction</a></li>
	<li><a href="https://www.r-bloggers.com/2015/12/how-to-write-the-first-for-loop-in-r/" title="How to write the first for loop in R">How to write the first for loop in R</a></li>
	<li><a href="https://www.r-bloggers.com/2016/11/5-ways-to-subset-a-data-frame-in-r/" title="5 Ways to Subset a Data Frame in R">5 Ways to Subset a Data Frame in R</a></li>
	<li><a href="https://www.r-bloggers.com/2020/11/the-mathematics-and-statistics-of-infectious-disease-outbreaks/" title="The Mathematics and Statistics of Infectious Disease Outbreaks">The Mathematics and Statistics of Infectious Disease Outbreaks</a></li>
	<li><a href="https://www.r-bloggers.com/2020/01/how-to-remove-outliers-in-r/" title="How to Remove Outliers in R">How to Remove Outliers in R</a></li>
	<li><a href="https://www.r-bloggers.com/2010/02/r-sorting-a-data-frame-by-the-contents-of-a-column/" title="R – Sorting a data frame by the contents of a column">R – Sorting a data frame by the contents of a column</a></li>
	<li><a href="https://www.r-bloggers.com/2013/08/date-formats-in-r/" title="Date Formats in R">Date Formats in R</a></li>
</ul>
</div><div id="text-18" class="sb-widget widget_text"><h4 class="widget-title">Sponsors</h4>			<div class="textwidget"><div style="min-height: 2055px;">

<script data-cfasync="false" type="text/javascript">
// https://support.cloudflare.com/hc/en-us/articles/200169436-How-can-I-have-Rocket-Loader-ignore-my-script-s-in-Automatic-Mode-
// this must be placed higher. Otherwise it doesn't work.
// data-cfasync="false" is for making sure cloudflares' rocketcache doesn't interfeare with this
// in this case it only works because it was used at the original script in the text widget


function createCookie(name,value,days) {
    var expires = "";
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + value + expires + "; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}

// no longer use async because of google
// async 
async function readTextFile(file)
{
	// Helps people browse between pages without the need to keep downloading the same 
	// ads txt page everytime. This way, it allows them to use their browser's cache.
	var random_number = readCookie("ad_random_number_cookie");
	if(random_number == null) {
		var random_number = Math.floor(Math.random()*100*(new Date().getTime()/10000000000));
		createCookie("ad_random_number_cookie",random_number,1)
	}
	
    file += '?t='+random_number;
    var rawFile = new XMLHttpRequest();
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
                // var allText = rawFile.responseText;
                // document.write(allText);
                document.write(rawFile.responseText);
            }
        }
    }
    rawFile.open("GET", file, false);
    rawFile.send(null);
}

// readTextFile('https://raw.githubusercontent.com/Raynos/file-store/master/temp.txt');

readTextFile("https://www.r-bloggers.com/wp-content/uploads/text-widget_anti-cache.txt");


</script><a href="http://mango-solutions.com/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://mango-solutions.com/&#39;, &#39;http://mango-solutions.com/&#39;]);">
<picture style="min-width:300px;min-height:200px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/11/Rbloggers-advert.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/Rbloggers-advert.jpg" alt="Mango solutions">  
</picture>
</a>


<!--
<a href="https://mango-solutions.com/" rel="nofollow" target="_blank" onclick="_gaq.push(['_trackEvent', 'outbound-widget-ads', 'https://www.mango-solutions.com', 'mango-solutions.com']);" >
<picture style="min-width:300px;min-height:200px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/Rbloggers-advert.webp" type="image/webp">
  <img src="https://www.r-bloggers.com/wp-content/uploads/2020/04/Rbloggers-advert.jpg" alt="Mango solutions">  
</picture>
</a>
-->

<!--
<br /><hr>
<a href="https://www.datacamp.com/?tap_a=5644-dce66f&tap_s=10907-287229" rel="nofollow" target="_blank" onclick="_gaq.push(['_trackEvent', 'outbound-widget-ads', 'https://www.datacamp.com/?tap_a=5644-dce66f&tap_s=10907-287229', 'datacamp.com']);">
<picture style="min-width:300px;min-height:250px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/DataCamp-Learn-R-by-Doing-300x250.webp" type="image/webp">
  <img src="https://www.r-bloggers.com/wp-content/uploads/2017/12/DataCamp-Learn-R-by-Doing-300x250.png" alt="Datacamp">  
</picture>
</a>
-->

<br><hr>
<a href="https://www.datacamp.com/?tap_a=5644-dce66f&amp;tap_s=10907-287229" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.datacamp.com/?tap_a=5644-dce66f&amp;tap_s=10907-287229&#39;, &#39;datacamp.com&#39;]);">
<picture style="min-width:300px;min-height:250px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/11/datacamp_learn_R.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/datacamp_learn_R.png" alt="Datacamp">  
</picture>
</a>


<br><hr>
<a href="https://www.rstudio.com/products/quickstart/?utm_source=rblogger&amp;utm_medium=team&amp;utm_campaign=teampromo" rel="nofollow" target="_blank">
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/r-bloggers-team.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/r-bloggers-team.jpg" alt="RStudio">  
</picture>
</a>



<br><hr>
<a href="https://www.highstat.com/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.highstat.com/&#39;, &#39;highstat.com&#39;]);">
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/BookSpatTemp.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/BookSpatTemp.jpg" alt="Zero Inflated Models and Generalized Linear Mixed Models with R">  
</picture>
</a>


<!--
<br /><hr>
<a href="http://blueskystatistics.casky.in/?utm_source=r-bloggers&utm_medium=banner&utm_campaign=download_bluesky_stats" rel="nofollow" target="_blank" onclick="_gaq.push(['_trackEvent', 'outbound-widget-ads', 'http://blueskystatistics.casky.in/?utm_source=r-bloggers&utm_medium=banner&utm_campaign=download_bluesky_stats', 'blueskystatistics.casky.in']);"> 
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/09/blueSky-300x125-c.webp" type="image/webp">
  <img src="https://www.r-bloggers.com/wp-content/uploads/2020/09/blueSky-300x125-c.jpg" alt="blueskystatistics">  
</picture>
</a>
-->




<br><hr>
<a href="https://www.yuna.eoda.de/yuna-elements/?utm_source=R-Bloggers&amp;utm_medium=Banner&amp;utm_campaign=R-Banner%2019062020" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.eoda.de/en/about-the-dse.html&#39;, &#39;eoda.de&#39;]);"> 
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/r-bloggers-banner.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/r-bloggers-banner.jpg" alt="Eoda">  
</picture>
</a>


<br><hr>
<a href="https://appsilon.com/careers/?utm_source=rbloggers&amp;utm_medium=banner&amp;utm_campaign=rbloggers_careers" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;appsilon.com&#39;, &#39;appsilon.com&#39;]);"> 
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/11/2020-11-18-appsilon.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/2020-11-18-appsilon.png" alt="appsilon.com">  
</picture>
</a>


<!--

<br /><hr>
<a href="https://appsilon.com/rstudio-appsilon-enabling-remote-data-science-teams/?utm_source=rbloggers&utm_medium=banner&utm_campaign=rstudio_webinar" rel="nofollow" target="_blank" onclick="_gaq.push(['_trackEvent', 'outbound-widget-ads', 'appsilon.com', 'appsilon.com']);"> 
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/150_Rstudio-e1595396697526.webp" type="image/webp">
  <img src="https://www.r-bloggers.com/wp-content/uploads/2020/07/150_Rstudio-e1595396697526.jpg" alt="appsilon.com">  
</picture>
</a>

<br /><hr>
<a href="https://appsilon.com/shiny/?utm_source=rbloggers&utm_medium=banner&utm_campaign=rbloggers_scale" rel="nofollow" target="_blank" onclick="_gaq.push(['_trackEvent', 'outbound-widget-ads', 'appsilon.com', 'appsilon.com']);"> 
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/150_RShiny_banner3-e1594129587882.webp" type="image/webp">
  <img src="https://www.r-bloggers.com/wp-content/uploads/2020/07/150_RShiny_banner3-e1594129587882.jpg" alt="appsilon.com">  
</picture>
</a>
-->


<br><hr>

<script async="" data-cfasync="false" src="./Ejemplo_RBloggers_files/f.txt"></script>
<!-- r-bloggers sidebar 336*280 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:280px" data-ad-client="ca-pub-6149057907449803" data-ad-slot="1192261709"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>








<br><hr>
<a href="https://www.jumpingrivers.com/?utm_source=rbloggers&amp;utm_campaign=1&amp;utm_medium=banner" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.jumpingrivers.com/&#39;, &#39;jumpingrivers.com&#39;]);">
<picture style="min-width:300px;min-height:122px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/jr-AD300_125.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/jr-AD300_125.jpg" alt="jumping rivers">  
</picture>
</a>



<br><hr>
<a href="https://www.statworx.com/de/data-science/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.statworx.com/de/data-science/&#39;, &#39;statworx.com&#39;]);">
<picture style="min-width:300px;min-height:123px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/2017-10-22-statworx-banner.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/2017-10-22-statworx-banner.png" alt="STATWORX">  
</picture>
</a>



<!--
Stopped...
<br /><hr>
<a href="https://yottamine.com/try-yottamine-now" rel="nofollow" target="_blank" onclick="_gaq.push(['_trackEvent', 'outbound-widget-ads', 'http://yottamine.com/try-yottamine-now', 'yottamine.com']);">
<picture style="min-width:300px;min-height:150px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/R-Blog_Speed.webp" type="image/webp">
  <img src="https://www.r-bloggers.com/wp-content/uploads/2014/09/R-Blog_Speed.png" alt="yottamine">  
</picture>
</a>
-->




<br><hr>
<a href="https://www.6sigma.us/six-sigma-online-training.php" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.6sigma.us/six-sigma-online-training.php&#39;, &#39;6sigma.us&#39;]);">
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/sixsigma300x125-1.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/sixsigma300x125-1.jpg" alt="Six Sigma Online Training">  
</picture>
</a>





<br><hr>
<a href="http://mng.bz/dyoD" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://mng.bz/dyoD&#39;, &#39;http://mng.bz/dyoD&#39;]);">
<picture style="min-width:300px;min-height:125px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/07/R-bloggers.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/R-bloggers.png" alt="http://mng.bz/dyoD">  
</picture>
</a>


<br><hr>
<a href="https://www.chapman.edu/scst/graduate/index.aspx?utm_source=newspaper-magazine-printed-piece&amp;utm_medium=web-referral&amp;utm_campaign=schmid-graduate-awareness&amp;utm_term=nov-1-2020-to-may-31-2021&amp;utm_content=cads-programs-awareness" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;chapman.edu&#39;, &#39;chapman.edu&#39;]);">

<picture style="min-width:300px;min-height:200px;">
  <source media="(min-width:300px)" srcset="https://www.r-bloggers.com/wp-content/uploads/2020/11/20-338933-Schmid-Sidebar-Banner-ad-R-Bloggers-Sponsorship.webp" type="image/webp">
  <img src="./Ejemplo_RBloggers_files/20-338933-Schmid-Sidebar-Banner-ad-R-Bloggers-Sponsorship.jpg" alt="chapman.edu" title="chapman.edu" style="display: none !important;">
</picture>



<br><hr>
</a><a href="https://neptune.ai/landings/experiment-tracking-in-r?utm_source=r-bloggers&amp;utm_medium=banner&amp;utm_campaign=experiment-tracking-for-r" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://neptune.ai/landings/experiment-tracking-in-r&#39;, &#39;https://neptune.ai/landings/experiment-tracking-in-r&#39;]);">
<picture style="min-width:300px;min-height:125px;">
    <img src="./Ejemplo_RBloggers_files/r-bloggers_2020-04-17.png" alt="https://neptune.ai/landings/experiment-tracking-in-r" title="https://neptune.ai/landings/experiment-tracking-in-r">
</picture>
</a>





<br><hr>
Our ads respect your privacy. Read our <a href="https://www.r-bloggers.com/privacy-policy/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.r-bloggers.com/privacy-policy/&#39;, &#39;r-bloggers.com/privacy-policy/&#39;]);">Privacy Policy page</a> to learn more.



<br><hr>
<p>
<a href="https://www.r-bloggers.com/contact-us/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.r-bloggers.com/contact-us/&#39;, &#39;r-bloggers.com/contact-us&#39;]);">Contact us </a> if you wish to help support R-bloggers, and place <strong>your banner here</strong>.
</p>




<!-- Google Analytics -->
<script>
// https://developers.google.com/analytics/devguides/collection/analyticsjs/

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-419807-53', 'auto');
__gaTracker('set', 'anonymizeIp', true);
// ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



</div></div>
		</div>
		<div id="recent-posts-3" class="sb-widget widget_recent_entries">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/covid-19-dashboard-page-now-up/">COVID-19 dashboard page now up</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/the-purpose-of-our-data-science-chalk-talk-series/">The Purpose of our Data Science Chalk Talk Series</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/online-tests-for-testvision-with-r-exams/">Online Tests for TestVision with R/exams</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/gold-mining-week-11-2020/">Gold-Mining Week 11 (2020)</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/little-useless-useful-r-functions-making-scatter-plot-from-an-image/">Little useless-useful R functions – Making scatter plot from an image</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/updated-apache-drill-r-jdbc-interface-package-sergeant-caffeinated-with-dbplyr-2-x-compatibility/">Updated Apache Drill R JDBC Interface Package {sergeant.caffeinated} With {dbplyr} 2.x Compatibility</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/graphical-user-interfaces-were-a-mistake-but-you-can-still-make-things-right/">Graphical User Interfaces were a mistake but you can still make things right</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/boosting-nonlinear-penalized-least-squares/">Boosting nonlinear penalized least squares</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/bio7-3-2-released/">Bio7 3.2 Released</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/lake-erie-pileup/">Lake Erie Pileup</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/global-lockdown-effects-on-social-distancing-a-graphical-primer/">Global Lockdown Effects on Social Distancing: A Graphical Primer</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/the-mathematics-and-statistics-of-infectious-disease-outbreaks/">The Mathematics and Statistics of Infectious Disease Outbreaks</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/deloitte-names-appsilon-a-rising-star-in-the-2020-fast-50-list/">Deloitte Names Appsilon a Rising Star in the 2020 Fast 50 List</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/why-r-webinar-satellite-imagery-analysis-in-r/">Why R Webinar – Satellite imagery analysis in R</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2020/11/october-2020-top-40-new-cran-packages/">October 2020: “Top 40” New CRAN Packages</a>
									</li>
					</ul>

		</div><div id="rss-7" class="sb-widget widget_rss"><h4 class="widget-title"><a class="rsswidget" href="https://feeds.feedburner.com/Rjobs"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="./Ejemplo_RBloggers_files/rss.png" alt="RSS"></a> <a class="rsswidget" href="https://www.r-users.com/">Jobs for R-users</a></h4><ul><li><a class="rsswidget" href="https://feedproxy.google.com/~r/RJobs/~3/XUqQfUzxziw/">Junior Data Scientist / Quantitative economist</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/RJobs/~3/C2KYkXtMCHw/">Senior Quantitative Analyst</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/RJobs/~3/z5mEr8qKkUI/">R programmer</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/RJobs/~3/wi3Gfi8GNqA/">Data Scientist – CGIAR Excellence in Agronomy (Ref No: DDG-R4D/DS/1/CG/EA/06/20)</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/RJobs/~3/aSK4JGQQOfg/">Data Analytics Auditor, Future of Audit Lead @ London or Newcastle</a></li></ul></div><div id="rss-9" class="sb-widget widget_rss"><h4 class="widget-title"><a class="rsswidget" href="https://feeds.feedburner.com/Python-bloggers"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="./Ejemplo_RBloggers_files/rss.png" alt="RSS"></a> <a class="rsswidget" href="https://python-bloggers.com/">python-bloggers.com (python/data-science news)</a></h4><ul><li><a class="rsswidget" href="https://feedproxy.google.com/~r/Python-bloggers/~3/JO5b5rOj-yQ/">Boosting nonlinear penalized least squares</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/Python-bloggers/~3/ronz_JFOKBc/">13 Use Cases for Data-Driven Digital Transformation in Finance</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/Python-bloggers/~3/0VATSSEdjnE/">MongoDB and Python – Simplifying Your Schema – ETL Part 2</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/Python-bloggers/~3/tHtU0WokqT8/">MongoDB and Python – Inserting and Retrieving Data – ETL Part 1</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/Python-bloggers/~3/u5ZrlxPVpnE/">Round about the kernel</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/Python-bloggers/~3/TgIQMXNuroQ/">Building a Data-Driven Culture at Bloomberg</a></li><li><a class="rsswidget" href="https://feedproxy.google.com/~r/Python-bloggers/~3/LDNrc-as0s8/">See Appsilon Presentations on Computer Vision and Scaling Shiny at Why R? 2020</a></li></ul></div><div id="text-16" class="sb-widget widget_text">			<div class="textwidget"><strong><a href="https://www.r-bloggers.com/blogs-list/">Full list of contributing R-bloggers</a></strong></div>
		</div><div id="archives-3" class="sb-widget widget_archive"><h4 class="widget-title">Archives</h4>		<label class="screen-reader-text" for="archives-dropdown-3">Archives</label>
		<select id="archives-dropdown-3" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value="https://www.r-bloggers.com/2020/11/"> November 2020 &nbsp;(156)</option>
	<option value="https://www.r-bloggers.com/2020/10/"> October 2020 &nbsp;(222)</option>
	<option value="https://www.r-bloggers.com/2020/09/"> September 2020 &nbsp;(195)</option>
	<option value="https://www.r-bloggers.com/2020/08/"> August 2020 &nbsp;(184)</option>
	<option value="https://www.r-bloggers.com/2020/07/"> July 2020 &nbsp;(235)</option>
	<option value="https://www.r-bloggers.com/2020/06/"> June 2020 &nbsp;(206)</option>
	<option value="https://www.r-bloggers.com/2020/05/"> May 2020 &nbsp;(291)</option>
	<option value="https://www.r-bloggers.com/2020/04/"> April 2020 &nbsp;(299)</option>
	<option value="https://www.r-bloggers.com/2020/03/"> March 2020 &nbsp;(252)</option>
	<option value="https://www.r-bloggers.com/2020/02/"> February 2020 &nbsp;(226)</option>
	<option value="https://www.r-bloggers.com/2020/01/"> January 2020 &nbsp;(215)</option>
	<option value="https://www.r-bloggers.com/2019/12/"> December 2019 &nbsp;(220)</option>
	<option value="https://www.r-bloggers.com/2019/11/"> November 2019 &nbsp;(201)</option>
	<option value="https://www.r-bloggers.com/2019/10/"> October 2019 &nbsp;(216)</option>
	<option value="https://www.r-bloggers.com/2019/09/"> September 2019 &nbsp;(212)</option>
	<option value="https://www.r-bloggers.com/2019/08/"> August 2019 &nbsp;(259)</option>
	<option value="https://www.r-bloggers.com/2019/07/"> July 2019 &nbsp;(233)</option>
	<option value="https://www.r-bloggers.com/2019/06/"> June 2019 &nbsp;(221)</option>
	<option value="https://www.r-bloggers.com/2019/05/"> May 2019 &nbsp;(254)</option>
	<option value="https://www.r-bloggers.com/2019/04/"> April 2019 &nbsp;(276)</option>
	<option value="https://www.r-bloggers.com/2019/03/"> March 2019 &nbsp;(298)</option>
	<option value="https://www.r-bloggers.com/2019/02/"> February 2019 &nbsp;(261)</option>
	<option value="https://www.r-bloggers.com/2019/01/"> January 2019 &nbsp;(286)</option>
	<option value="https://www.r-bloggers.com/2018/12/"> December 2018 &nbsp;(257)</option>
	<option value="https://www.r-bloggers.com/2018/11/"> November 2018 &nbsp;(289)</option>
	<option value="https://www.r-bloggers.com/2018/10/"> October 2018 &nbsp;(308)</option>
	<option value="https://www.r-bloggers.com/2018/09/"> September 2018 &nbsp;(291)</option>
	<option value="https://www.r-bloggers.com/2018/08/"> August 2018 &nbsp;(270)</option>
	<option value="https://www.r-bloggers.com/2018/07/"> July 2018 &nbsp;(333)</option>
	<option value="https://www.r-bloggers.com/2018/06/"> June 2018 &nbsp;(298)</option>
	<option value="https://www.r-bloggers.com/2018/05/"> May 2018 &nbsp;(321)</option>
	<option value="https://www.r-bloggers.com/2018/04/"> April 2018 &nbsp;(301)</option>
	<option value="https://www.r-bloggers.com/2018/03/"> March 2018 &nbsp;(291)</option>
	<option value="https://www.r-bloggers.com/2018/02/"> February 2018 &nbsp;(241)</option>
	<option value="https://www.r-bloggers.com/2018/01/"> January 2018 &nbsp;(330)</option>
	<option value="https://www.r-bloggers.com/2017/12/"> December 2017 &nbsp;(261)</option>
	<option value="https://www.r-bloggers.com/2017/11/"> November 2017 &nbsp;(270)</option>
	<option value="https://www.r-bloggers.com/2017/10/"> October 2017 &nbsp;(290)</option>
	<option value="https://www.r-bloggers.com/2017/09/"> September 2017 &nbsp;(294)</option>
	<option value="https://www.r-bloggers.com/2017/08/"> August 2017 &nbsp;(340)</option>
	<option value="https://www.r-bloggers.com/2017/07/"> July 2017 &nbsp;(283)</option>
	<option value="https://www.r-bloggers.com/2017/06/"> June 2017 &nbsp;(317)</option>
	<option value="https://www.r-bloggers.com/2017/05/"> May 2017 &nbsp;(349)</option>
	<option value="https://www.r-bloggers.com/2017/04/"> April 2017 &nbsp;(324)</option>
	<option value="https://www.r-bloggers.com/2017/03/"> March 2017 &nbsp;(365)</option>
	<option value="https://www.r-bloggers.com/2017/02/"> February 2017 &nbsp;(317)</option>
	<option value="https://www.r-bloggers.com/2017/01/"> January 2017 &nbsp;(367)</option>
	<option value="https://www.r-bloggers.com/2016/12/"> December 2016 &nbsp;(347)</option>
	<option value="https://www.r-bloggers.com/2016/11/"> November 2016 &nbsp;(294)</option>
	<option value="https://www.r-bloggers.com/2016/10/"> October 2016 &nbsp;(306)</option>
	<option value="https://www.r-bloggers.com/2016/09/"> September 2016 &nbsp;(254)</option>
	<option value="https://www.r-bloggers.com/2016/08/"> August 2016 &nbsp;(287)</option>
	<option value="https://www.r-bloggers.com/2016/07/"> July 2016 &nbsp;(327)</option>
	<option value="https://www.r-bloggers.com/2016/06/"> June 2016 &nbsp;(263)</option>
	<option value="https://www.r-bloggers.com/2016/05/"> May 2016 &nbsp;(292)</option>
	<option value="https://www.r-bloggers.com/2016/04/"> April 2016 &nbsp;(260)</option>
	<option value="https://www.r-bloggers.com/2016/03/"> March 2016 &nbsp;(302)</option>
	<option value="https://www.r-bloggers.com/2016/02/"> February 2016 &nbsp;(268)</option>
	<option value="https://www.r-bloggers.com/2016/01/"> January 2016 &nbsp;(337)</option>
	<option value="https://www.r-bloggers.com/2015/12/"> December 2015 &nbsp;(304)</option>
	<option value="https://www.r-bloggers.com/2015/11/"> November 2015 &nbsp;(234)</option>
	<option value="https://www.r-bloggers.com/2015/10/"> October 2015 &nbsp;(259)</option>
	<option value="https://www.r-bloggers.com/2015/09/"> September 2015 &nbsp;(238)</option>
	<option value="https://www.r-bloggers.com/2015/08/"> August 2015 &nbsp;(264)</option>
	<option value="https://www.r-bloggers.com/2015/07/"> July 2015 &nbsp;(243)</option>
	<option value="https://www.r-bloggers.com/2015/06/"> June 2015 &nbsp;(213)</option>
	<option value="https://www.r-bloggers.com/2015/05/"> May 2015 &nbsp;(235)</option>
	<option value="https://www.r-bloggers.com/2015/04/"> April 2015 &nbsp;(211)</option>
	<option value="https://www.r-bloggers.com/2015/03/"> March 2015 &nbsp;(259)</option>
	<option value="https://www.r-bloggers.com/2015/02/"> February 2015 &nbsp;(212)</option>
	<option value="https://www.r-bloggers.com/2015/01/"> January 2015 &nbsp;(245)</option>
	<option value="https://www.r-bloggers.com/2014/12/"> December 2014 &nbsp;(236)</option>
	<option value="https://www.r-bloggers.com/2014/11/"> November 2014 &nbsp;(221)</option>
	<option value="https://www.r-bloggers.com/2014/10/"> October 2014 &nbsp;(218)</option>
	<option value="https://www.r-bloggers.com/2014/09/"> September 2014 &nbsp;(259)</option>
	<option value="https://www.r-bloggers.com/2014/08/"> August 2014 &nbsp;(217)</option>
	<option value="https://www.r-bloggers.com/2014/07/"> July 2014 &nbsp;(235)</option>
	<option value="https://www.r-bloggers.com/2014/06/"> June 2014 &nbsp;(241)</option>
	<option value="https://www.r-bloggers.com/2014/05/"> May 2014 &nbsp;(243)</option>
	<option value="https://www.r-bloggers.com/2014/04/"> April 2014 &nbsp;(260)</option>
	<option value="https://www.r-bloggers.com/2014/03/"> March 2014 &nbsp;(289)</option>
	<option value="https://www.r-bloggers.com/2014/02/"> February 2014 &nbsp;(269)</option>
	<option value="https://www.r-bloggers.com/2014/01/"> January 2014 &nbsp;(263)</option>
	<option value="https://www.r-bloggers.com/2013/12/"> December 2013 &nbsp;(264)</option>
	<option value="https://www.r-bloggers.com/2013/11/"> November 2013 &nbsp;(241)</option>
	<option value="https://www.r-bloggers.com/2013/10/"> October 2013 &nbsp;(234)</option>
	<option value="https://www.r-bloggers.com/2013/09/"> September 2013 &nbsp;(215)</option>
	<option value="https://www.r-bloggers.com/2013/08/"> August 2013 &nbsp;(223)</option>
	<option value="https://www.r-bloggers.com/2013/07/"> July 2013 &nbsp;(254)</option>
	<option value="https://www.r-bloggers.com/2013/06/"> June 2013 &nbsp;(272)</option>
	<option value="https://www.r-bloggers.com/2013/05/"> May 2013 &nbsp;(260)</option>
	<option value="https://www.r-bloggers.com/2013/04/"> April 2013 &nbsp;(279)</option>
	<option value="https://www.r-bloggers.com/2013/03/"> March 2013 &nbsp;(277)</option>
	<option value="https://www.r-bloggers.com/2013/02/"> February 2013 &nbsp;(294)</option>
	<option value="https://www.r-bloggers.com/2013/01/"> January 2013 &nbsp;(343)</option>
	<option value="https://www.r-bloggers.com/2012/12/"> December 2012 &nbsp;(308)</option>
	<option value="https://www.r-bloggers.com/2012/11/"> November 2012 &nbsp;(277)</option>
	<option value="https://www.r-bloggers.com/2012/10/"> October 2012 &nbsp;(308)</option>
	<option value="https://www.r-bloggers.com/2012/09/"> September 2012 &nbsp;(270)</option>
	<option value="https://www.r-bloggers.com/2012/08/"> August 2012 &nbsp;(263)</option>
	<option value="https://www.r-bloggers.com/2012/07/"> July 2012 &nbsp;(247)</option>
	<option value="https://www.r-bloggers.com/2012/06/"> June 2012 &nbsp;(298)</option>
	<option value="https://www.r-bloggers.com/2012/05/"> May 2012 &nbsp;(287)</option>
	<option value="https://www.r-bloggers.com/2012/04/"> April 2012 &nbsp;(295)</option>
	<option value="https://www.r-bloggers.com/2012/03/"> March 2012 &nbsp;(304)</option>
	<option value="https://www.r-bloggers.com/2012/02/"> February 2012 &nbsp;(264)</option>
	<option value="https://www.r-bloggers.com/2012/01/"> January 2012 &nbsp;(280)</option>
	<option value="https://www.r-bloggers.com/2011/12/"> December 2011 &nbsp;(251)</option>
	<option value="https://www.r-bloggers.com/2011/11/"> November 2011 &nbsp;(261)</option>
	<option value="https://www.r-bloggers.com/2011/10/"> October 2011 &nbsp;(281)</option>
	<option value="https://www.r-bloggers.com/2011/09/"> September 2011 &nbsp;(187)</option>
	<option value="https://www.r-bloggers.com/2011/08/"> August 2011 &nbsp;(258)</option>
	<option value="https://www.r-bloggers.com/2011/07/"> July 2011 &nbsp;(219)</option>
	<option value="https://www.r-bloggers.com/2011/06/"> June 2011 &nbsp;(225)</option>
	<option value="https://www.r-bloggers.com/2011/05/"> May 2011 &nbsp;(239)</option>
	<option value="https://www.r-bloggers.com/2011/04/"> April 2011 &nbsp;(268)</option>
	<option value="https://www.r-bloggers.com/2011/03/"> March 2011 &nbsp;(249)</option>
	<option value="https://www.r-bloggers.com/2011/02/"> February 2011 &nbsp;(205)</option>
	<option value="https://www.r-bloggers.com/2011/01/"> January 2011 &nbsp;(209)</option>
	<option value="https://www.r-bloggers.com/2010/12/"> December 2010 &nbsp;(188)</option>
	<option value="https://www.r-bloggers.com/2010/11/"> November 2010 &nbsp;(172)</option>
	<option value="https://www.r-bloggers.com/2010/10/"> October 2010 &nbsp;(219)</option>
	<option value="https://www.r-bloggers.com/2010/09/"> September 2010 &nbsp;(185)</option>
	<option value="https://www.r-bloggers.com/2010/08/"> August 2010 &nbsp;(203)</option>
	<option value="https://www.r-bloggers.com/2010/07/"> July 2010 &nbsp;(175)</option>
	<option value="https://www.r-bloggers.com/2010/06/"> June 2010 &nbsp;(167)</option>
	<option value="https://www.r-bloggers.com/2010/05/"> May 2010 &nbsp;(164)</option>
	<option value="https://www.r-bloggers.com/2010/04/"> April 2010 &nbsp;(152)</option>
	<option value="https://www.r-bloggers.com/2010/03/"> March 2010 &nbsp;(165)</option>
	<option value="https://www.r-bloggers.com/2010/02/"> February 2010 &nbsp;(135)</option>
	<option value="https://www.r-bloggers.com/2010/01/"> January 2010 &nbsp;(121)</option>
	<option value="https://www.r-bloggers.com/2009/12/"> December 2009 &nbsp;(126)</option>
	<option value="https://www.r-bloggers.com/2009/11/"> November 2009 &nbsp;(66)</option>
	<option value="https://www.r-bloggers.com/2009/10/"> October 2009 &nbsp;(87)</option>
	<option value="https://www.r-bloggers.com/2009/09/"> September 2009 &nbsp;(65)</option>
	<option value="https://www.r-bloggers.com/2009/08/"> August 2009 &nbsp;(56)</option>
	<option value="https://www.r-bloggers.com/2009/07/"> July 2009 &nbsp;(64)</option>
	<option value="https://www.r-bloggers.com/2009/06/"> June 2009 &nbsp;(54)</option>
	<option value="https://www.r-bloggers.com/2009/05/"> May 2009 &nbsp;(35)</option>
	<option value="https://www.r-bloggers.com/2009/04/"> April 2009 &nbsp;(38)</option>
	<option value="https://www.r-bloggers.com/2009/03/"> March 2009 &nbsp;(40)</option>
	<option value="https://www.r-bloggers.com/2009/02/"> February 2009 &nbsp;(33)</option>
	<option value="https://www.r-bloggers.com/2009/01/"> January 2009 &nbsp;(42)</option>
	<option value="https://www.r-bloggers.com/2008/12/"> December 2008 &nbsp;(16)</option>
	<option value="https://www.r-bloggers.com/2008/11/"> November 2008 &nbsp;(14)</option>
	<option value="https://www.r-bloggers.com/2008/10/"> October 2008 &nbsp;(10)</option>
	<option value="https://www.r-bloggers.com/2008/09/"> September 2008 &nbsp;(8)</option>
	<option value="https://www.r-bloggers.com/2008/08/"> August 2008 &nbsp;(11)</option>
	<option value="https://www.r-bloggers.com/2008/07/"> July 2008 &nbsp;(7)</option>
	<option value="https://www.r-bloggers.com/2008/06/"> June 2008 &nbsp;(8)</option>
	<option value="https://www.r-bloggers.com/2008/05/"> May 2008 &nbsp;(8)</option>
	<option value="https://www.r-bloggers.com/2008/04/"> April 2008 &nbsp;(4)</option>
	<option value="https://www.r-bloggers.com/2008/03/"> March 2008 &nbsp;(5)</option>
	<option value="https://www.r-bloggers.com/2008/02/"> February 2008 &nbsp;(6)</option>
	<option value="https://www.r-bloggers.com/2008/01/"> January 2008 &nbsp;(10)</option>
	<option value="https://www.r-bloggers.com/2007/12/"> December 2007 &nbsp;(3)</option>
	<option value="https://www.r-bloggers.com/2007/11/"> November 2007 &nbsp;(5)</option>
	<option value="https://www.r-bloggers.com/2007/10/"> October 2007 &nbsp;(9)</option>
	<option value="https://www.r-bloggers.com/2007/09/"> September 2007 &nbsp;(7)</option>
	<option value="https://www.r-bloggers.com/2007/08/"> August 2007 &nbsp;(21)</option>
	<option value="https://www.r-bloggers.com/2007/07/"> July 2007 &nbsp;(9)</option>
	<option value="https://www.r-bloggers.com/2007/06/"> June 2007 &nbsp;(3)</option>
	<option value="https://www.r-bloggers.com/2007/05/"> May 2007 &nbsp;(3)</option>
	<option value="https://www.r-bloggers.com/2007/04/"> April 2007 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2007/03/"> March 2007 &nbsp;(5)</option>
	<option value="https://www.r-bloggers.com/2007/02/"> February 2007 &nbsp;(4)</option>
	<option value="https://www.r-bloggers.com/2006/11/"> November 2006 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2006/10/"> October 2006 &nbsp;(2)</option>
	<option value="https://www.r-bloggers.com/2006/08/"> August 2006 &nbsp;(3)</option>
	<option value="https://www.r-bloggers.com/2006/07/"> July 2006 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2006/06/"> June 2006 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2006/05/"> May 2006 &nbsp;(3)</option>
	<option value="https://www.r-bloggers.com/2006/04/"> April 2006 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2006/03/"> March 2006 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2006/02/"> February 2006 &nbsp;(5)</option>
	<option value="https://www.r-bloggers.com/2006/01/"> January 2006 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2005/10/"> October 2005 &nbsp;(1)</option>
	<option value="https://www.r-bloggers.com/2005/09/"> September 2005 &nbsp;(3)</option>
	<option value="https://www.r-bloggers.com/2005/05/"> May 2005 &nbsp;(1)</option>

		</select>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "archives-dropdown-3" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();
/* ]]> */
</script>
			</div><div id="linkcat-3349" class="sb-widget widget_links"><h4 class="widget-title">Other sites</h4>
	<ul class="xoxo blogroll">
<li><a href="http://www.proc-x.com/" title="SAS news gathered from bloggers">SAS blogs</a></li>
<li><a href="https://www.r-users.com/">Jobs for R-users</a></li>

	</ul>
</div>
</aside></div>
</div>
<div class="copyright-wrap">
	<p class="copyright">Copyright © 2020 | <a href="https://www.mhthemes.com/" rel="nofollow">MH Corporate basic by MH Themes</a></p>
</div>
</div>

<!--
TPC! Memory Usage (http://webjawns.com)
Memory Usage: 74716920
Memory Peak Usage: 74794936
WP Memory Limit: 820M
PHP Memory Limit: 800M
Checkpoints: 9
-->


<!-- Schema & Structured Data For WP v1.9.53 - -->
<script type="application/ld+json" class="saswp-schema-markup-output">
[{"@context":"https:\/\/schema.org","@graph":[{"@type":"Organization","@id":"https:\/\/www.r-bloggers.com#Organization","name":"R-bloggers","url":"http:\/\/www.r-bloggers.com","sameAs":[],"logo":{"@type":"ImageObject","url":"http:\/\/www.r-bloggers.com\/wp-content\/uploads\/2020\/07\/R_blogger_logo_02.png","width":"1061","height":"304"},"contactPoint":{"@type":"ContactPoint","contactType":"technical support","telephone":"","url":"https:\/\/www.r-bloggers.com\/contact-us\/"}},{"@type":"WebSite","@id":"https:\/\/www.r-bloggers.com#website","headline":"R-bloggers","name":"R-bloggers","description":"R news and tutorials contributed by hundreds of R bloggers","url":"https:\/\/www.r-bloggers.com","potentialAction":{"@type":"SearchAction","target":"https:\/\/www.r-bloggers.com\/?s={search_term_string}","query-input":"required name=search_term_string"},"publisher":{"@id":"https:\/\/www.r-bloggers.com#Organization"}},{"@context":"https:\/\/schema.org","@type":"WebPage","@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#webpage","name":"Convolutional Neural Networks in R | R-bloggers","url":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/","lastReviewed":"2018-07-08T05:05:23-06:00","reviewedBy":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http:\/\/www.r-bloggers.com\/wp-content\/uploads\/2020\/07\/R_blogger_logo_02.png","width":"1061","height":"304"},"name":"R-bloggers"},"inLanguage":"en-US","description":"Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you can freely access here, so give it a try! The plan here is to experiment with convolutional neural networks (CNNs), a form of deep learning. CNNs underlie &hellip; Continue reading Convolutional Neural Networks in&nbsp;R &rarr;","primaryImageOfPage":{"@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#primaryimage"},"mainContentOfPage":[[{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Home","url":"https:\/\/www.r-bloggers.com"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"About","url":"http:\/\/www.r-bloggers.com\/about\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"RSS","url":"https:\/\/feeds.feedburner.com\/RBloggers"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"add your blog!","url":"http:\/\/www.r-bloggers.com\/add-your-blog\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Learn R","url":"https:\/\/www.r-bloggers.com\/how-to-learn-r-2\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"R jobs","url":"https:\/\/www.r-users.com\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Submit a new job (it's free)","url":"https:\/\/www.r-users.com\/submit-job\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Browse latest jobs (also free)","url":"https:\/\/www.r-users.com\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Contact us","url":"http:\/\/www.r-bloggers.com\/contact-us\/"}]],"isPartOf":{"@id":"https:\/\/www.r-bloggers.com#website"},"breadcrumb":{"@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#breadcrumb"}},{"@type":"BreadcrumbList","@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/www.r-bloggers.com","name":"R-bloggers"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/www.r-bloggers.com\/category\/r-bloggers\/","name":"R bloggers"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/","name":"Convolutional Neural Networks in R | R-bloggers"}}]},{"@type":"Article","@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#article","url":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/","inLanguage":"en-US","mainEntityOfPage":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#webpage","headline":"Convolutional Neural Networks in R | R-bloggers","description":"Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you can freely access here, so give it a try! The plan here is to experiment with convolutional neural networks (CNNs), a form of deep learning. CNNs underlie &hellip; Continue reading Convolutional Neural Networks in&nbsp;R &rarr;","articleBody":"Can we teach a computer to distinguish cats and dogs?  Last time I promised to cover the graph-guided fused LASSO (GFLASSO) in a subsequent post. In the meantime, I wrote a GFLASSO R tutorial for DataCamp that you can freely access here, so give it a try! The plan here is to experiment with convolutional neural networks (CNNs), a form of deep learning. CNNs underlie most advanced recognition algorithms used by the major tech giants. The recent development of back-end optimization tools and hardware (from Intel, NVIDIA and Google to name a few) now enables training CNNs on conventional laptop machines, hence accessible to a broader audience. Today you will construct a binary classifier that can distinguish between dogs and cats from a set of 25,000 pictures, using the Keras R interface\u00a0powered by the\u00a0TensorFlow back-end engine. The code is available from a dedicated\u00a0repo so you don&#8217;t have to copy-paste the snippets below. \u00a0If you fall short of RAM\u00a0please consider adapting the script as to use less pictures or split, process and save them in separate instances. Finally, I encourage you to use the RStudio terminal shell to fetch the Dogs vs. Cats dataset from Kaggle via its new API feature. I will provide more detailed instructions below. If you want to pass the theory, scroll all the way down to the &#8220;Let&#8217;s get started with R&#8221; section. Enjoy! Neural Networks Driverless cars were out there as far back as 1989. Neural networks (NNs) have been around for a long time, so what triggered this craze around artificial intelligence and deep learning in recent years? The answer partly lies in Moore&#8217;s law and the remarkable improvement of hardware and computing power &#8211; we can now do a lot more with a lot less. The concept of NNs, as the name suggests, was inspired by the network of our own brain neurons. Neurons are very long cells, each with protrusions called dendrites that receive and propagate electrochemical signals from and to surrounding neurons, respectively. As a result, our brain cells form flexible, robust communication networks that sequentially process cascading inputs. This distributive process, akin to an assembly line, is supportive of sophisticated cognitive abilities such as music playing and painting. There is enough about NNs to write books and I do not intend to re-invent the wheel here. There are great free resources you can learn from, to master both basic and advanced concepts. I recommend the Intel\u00ae AI Academy, the \u00a0Coursera Machine Learning\u00a0course taught by Andrew Ng and DataCamp for the Python enthusiasts. I will cover only some key features pertaining to classification problems. Basic architecture A NN typically contains one input layer, one or more hidden layers, and an output layer. The input layer consists of your p predictors, or input units \/ nodes. Needless to say, it is generally good practice to center, scale and transform predictors, if not at least to speed up the optimization procedure. These input units can be connected to one or more hidden units in the first hidden layer. A hidden layer that is fully connected to the preceding layer\u00a0is designated dense. In the diagram below, both hidden layers are dense. Schematic representation of a neural network with two hidden layers The output layer computes the prediction, and the number of units therein is determined by the problem in hands. Conventionally, a binary classification problem requires a single output unit (as shown above), whereas a multiclass problem with k classes will require\u00a0k\u00a0corresponding output units. The former can simply use a sigmoid function to directly compute a probability, while the latter usually requires a softmax transformation, whereby all values across all k output units sum up to one and can thus be treated as probabilities. Rather than having categorical predictions you can retrieve the actual probabilities, which are much more informative, and inspect their quality using calibration plots and lift charts. These can be discussed in a future tutorial. Weights Every arrow displayed in the diagram above passes on an input that is associated with a weight. Each weight is essentially one of many coefficient estimates that contribute to the regressions computed in the nodes the corresponding arrows point to.\u00a0These are unknown parameters that must be tuned by the model as to minimize the loss function, using an optimization procedure. In effect, for any particular observation each neuron can be mathematically represented as , where b\u00a0denotes the intercept (also known as bias, and technically a weight itself) and\u00a0W\u00a0and x are\u00a0m-long vectors carrying the weights and values from all m\u00a0inputs, respectively. Before training, all weights are initialized with random values. Activation functions So far we have been assuming each unit carries a linear regression model, but there is more to that.\u00a0Every hidden unit is equipped with a sort of toggle switch that applies a filter on the regression output. In this context, different types of toggle switches are designated activation functions, i.e.  based on the mathematical representation above. On \/ off and high-pass toggle switches, for example, are encoded by sigmoid and rectified linear unit (ReLU) activation functions, respectively. The activation function in the output layer is particularly important, as I wrote before, as it must be picked according to the problem in hands. Loss and optimization So far we worked our way downstream the network, covering most elements necessary to make a prediction. However, we still did not discuss the actual training and weight fine-tuning. We need two things in place prior to training: i) a measure of goodness-of-fit, that compares predictions and known labels over all training observations, and ii) an optimization method that computes the gradient descent, essentially tweaking all weight estimates simultaneously, in the directions that improve the goodness-of-fit. For each of these we have loss functions and optimizers, respectively.\u00a0There are many types of loss functions, all aimed at quantifying prediction error. Later we will use cross-entropy, . As for optimization, we will use Adam, a popular stochastic optimization method. Great, but there is yet no explanation of how optimization resolves the dependencies among neurons in successive layers. Backpropagation Recap: to learn the parameters contained in the weight vectors that span l layers (), the model must plug in the predictors that cascade downstream and generate predictions, which in turn are contrasted to the actual labels.\u00a0At this point, the loss function kicks in and gauges error. To estimate all weights while considering their dependencies, backpropagation makes its way upstream, applying the chain rule. This chain rule calculates the gradients (i.e. partial derivatives w.r.t. the different weights) that reduce the error &#8220;dragged&#8221; from the output layer, a process governed by the optimizer. This all covers the building block of training &#8211; evaluating observations, establishing predictions and subsequently tuning weights to minimize error. Training is nothing but repeating it and updating the weights until convergence of the optimizer or reaching a limit. But how many observations exactly should we use in each iteration? Batch size There are three main options for how many observations to be used in each training step. Stochastic batch, mini-batch and full-batch feed in single observations, samples or the entire training set in each training step, respectively. In terms of runtime, the stochastic batch is faster compared to the full-batch. In terms of accuracy in the optimization (i.e. tweaking weights in the right direction), the full-batch is more accurate than the stochastic batch. In both cases, mini-batch sits in between. While there is no optimal method, it is important to consider the number of epochs can aid in extending iterations beyond the size of the training set. Regularization NNs must learn a myriad of parameters, bringing about the perils of overfitting. This problem can be tackled with various forms of regularization that constrain model flexibility. Weight decay acts much like  or LASSO penalties, introducing a budget for the magnitude of the weights. Dropout, to be used later, randomly drops connections based on a pre-specified probability. If you want to gain some more intuition about NNs, here is an interesting interactive page from TensorFlow. Convolutional Neural Networks Convolutional neural networks (CNNs) are a special type of NNs well poised for image processing and framed on the principles discussed above. The &#8216;convolutional&#8217; in the name owes to separate square patches of pixels in a image being processed through filters. As a result, the model can mathematically capture key visual cues such as textures and edges that help discerning classes. The beak of a bird, for example, is highly discriminative of birds among animals. In the example depicted below, the CNN would likely process beak-shaped structures along a chain of transformations involving convolution, pooling and flattening into layers, the last of which would see the relevant neurons activated, ideally resulting in  being the largest probability among the competing classes. Schematic representation of a convolutional neural network Note that images can be represented as numerical matrices, based on color intensity. Monochromatic images are processed with 2D convolutional layers, whereas colored ones require 3D convolutional layers &#8211; we will use the former. Also, note that the depth of the convolutional layers is determined by the total number of filters. Now briefly, some important CNN features. Kernel, stride and padding Kernels, also known as filters, convolve square blocks of pixels into scalars in subsequent convolutional layers.\u00a0In the animation below, you have a 3 x 3 kernel with ones running on the diagonal and off-diagonal, scanning an image from left to right, top to bottom. Example of image convolution Throughout the process, the kernel performs element-wise multiplication and sums up all products, into a single value passed to the subsequent convolutional layer. Note that the kernel is moving a pixel at a time. This is the stride,\u00a0the stepsize of the sliding window the kernel uses to convolve. Larger strides implicate more granular, smaller convolved features. Looking back to the figure above, note how central pixels are overrepresented compared to those lying on the edges of the image &#8211; while the very central pixel is picked up in every scan, the top-left pixel is picked up only once. More importantly, we might not be interested in downsampling. Padding, by adding zero-valued pixels around the borders of the image solves both problems by capturing more details and maintaining size, respectively. Pool Pooling is a strategic downsampling from a convolutional layer, rendering representations of predominant features in lower dimensions, preventing overfitting and alleviating computational demand. Two major types of pooling are average and max pooling. Provided a kernel and a stride, pooling amounts to convolution but instead taking either the average or maximum value per frame. Here is an illustrative example. Example of pooling  Flattening Flattening, as the name suggest, simply converts the last convolutional layer into a one-dimensional NN layer. It sets the stage for the actual predictions. All of the principles discussed regarding NNs (i.e. weights, activation, loss, optimization, backprogagation, batch size and regularization) apply to CNNs as well. Let&#8217;s get started with R First, you will need to install the Keras package and the TensorFlow dependency. Please follow the installation instructions here. If you are using NVIDIA cards, you might want to customise the installation with the command\u00a0install_keras()\u00a0and tap into the power of CUDAs. The default installation is CPU-based. Downloading Dogs vs. Cats The Kaggle API was recently developed to facilitate a fast, programatic access to datasets and competitions. To use the Kaggle API please register to Kaggle, create your kaggle.json token and accept the rules from the Dogs vs. Cats competition, as indicated in the\u00a0GitHub page. Using the terminal shell in RStudio, I suggest creating a folder\u00a0originalData\u00a0in your working directory, and then using the Kaggle API to store all contents associated with the competition therein.\u00a0If you prefer using your web browser or cannot use a terminal shell, download it directly from the competition page.\u00a0Finally, unzip the compressed files (i.e. train and test sets) into the working directory.  mkdir originalData\/ kaggle competitions download -c dogs-vs-cats -p originalData\/ unzip 'originalData\/*.zip'  You have just populated the working directory with the directories\u00a0train\u00a0and\u00a0test1\u00a0(besides\u00a0originalData), each containing 25,000 and 12,500 .jpg\u00a0pictures, respectively, of dogs and cats. Image processing Install the libraries listed below if necessary. We will start off by visualizing the second cat from the training dataset directly from RStudio, using the Viewer pane.\u00a0In case you wonder why the second, take a look into the first. Poor cat.  library(keras) library(EBImage) library(stringr) library(pbapply)  secondCat &lt;- readImage(&quot;train\/cat.1.jpg&quot;) display(secondCat)   At this stage I propose resizing the .jpg\u00a0images into 50 x 50 px grayscale images that we can easily manipulate numerically. For this purpose I adapted the extract_feature function from Shikun Li&#8217;s\u00a0image classification tutorial. After resizing, this function additionally flattens images to vectors of length 2500. We can then store the train and test sets as two data frames of size 25,000 x 2500 and 12,500 x 2500, respectively.  # Set image size width &lt;- 50 height &lt;- 50  extract_feature &lt;- function(dir_path, width, height, labelsExist  T) { img_size &lt;- width * height  ## List images in path images_names &lt;- list.files(dir_path)  if(labelsExist){ ## Select only cats or dogs images catdog &lt;- str_extract(images_names, &quot;^(cat|dog)&quot;) # Set cat  0 and dog  1 key &lt;- c(&quot;cat&quot;  0, &quot;dog&quot;  1) y &lt;- key }  print(paste(&quot;Start processing&quot;, length(images_names), &quot;images&quot;)) ## This function will resize an image, turn it into greyscale feature_list &lt;- pblapply(images_names, function(imgname) { ## Read image img &lt;- readImage(file.path(dir_path, imgname)) ## Resize image img_resized &lt;- resize(img, w  width, h  height) ## Set to grayscale (normalized to max) grayimg &lt;- channel(img_resized, &quot;gray&quot;) ## Get the image as a matrix img_matrix &lt;- grayimg@.Data ## Coerce to a vector (row-wise) img_vector &lt;- as.vector(t(img_matrix)) return(img_vector) }) ## bind the list of vector into matrix feature_matrix &lt;- do.call(rbind, feature_list) feature_matrix &lt;- as.data.frame(feature_matrix) ## Set names names(feature_matrix) &lt;- paste0(&quot;pixel&quot;, c(1:img_size))  if(labelsExist){ return(list(X  feature_matrix, y  y)) }else{ return(feature_matrix) } }  Next, we use the function to process both datasets by passing their corresponding directories. This should take about 20-30 minutes.  # Takes approx. 15min trainData &lt;- extract_feature(&quot;train\/&quot;, width, height) # Takes slightly less testData &lt;- extract_feature(&quot;test1\/&quot;, width, height, labelsExist  F)  Let&#8217;s look at how the transformation worked on the second cat and store the two data frames in a single R object.  # Check processing on second cat par(mar  rep(0, 4)) testCat &lt;- t(matrix(as.numeric(trainData$X), nrow  width, ncol  height, T)) image(t(apply(testCat, 2, rev)), col  gray.colors(12), axes  F)  # Save save(trainData, testData, file  &quot;catdogData.RData&quot;)   We can confidently\u00a0say any person could identify a cat in this particular instance. It is not always going to be the case, considering some images in both sets are ambiguous. Not only that, the downsizing to 50 x 50 px will inevitably complicate the recognition task. Training and validation The network structure was inspired from the\u00a0CIFAR10 CNN example in the Keras GitHub page. We first need to rearrange the train and test data frames into 4D tensors \/ arrays of shape 25000 x 50 x 50 x 1 (i.e. observations x height x width x channels). The binary classifier we are about to construct will have a single-unit output layer with sigmoid activation. As a result, and\u00a0because we encoded cats and dogs as 0 and 1, respectively, it will retrieve the probability of dog, . The Keras training framework\u00a0has three main stages:\u00a0i) one to specify the architecture, ii) one to compile the model by selecting the loss function, the optimizer and metrics of goodness-of-fit, and finally iii) one to fit the model by determining the number of epochs, batch size and validation split. If you are familiar with Python-based Keras, you will notice the R syntax becomes very similar with the usage of the pipe operator %&gt;%\u00a0from the magrittr package. Here is the proposed CNN architecture.  Setting padding to &#8216;same&#8217; maintains the original size, adding as many layers of zeros around the borders as determined by the kernel size, whereas to &#8216;valid&#8217; does not introduce padding and thus reduces size. The following code will rearrange the 4D tensors, define the model and train it. For the next 1-2 hours you will be able to monitor accuracy and loss on a hold-out sample (20%) of the training set.  # Fix structure for 2d CNN train_array % layer_dropout(rate  0.25) %&gt;%  layer_flatten() %&gt;% layer_dense(units  50, activation  \"relu\") %&gt;% layer_dropout(rate  0.25) %&gt;% layer_dense(units  1, activation  \"sigmoid\")  summary(model)  model %&gt;% compile( loss  'binary_crossentropy', optimizer  \"adam\", metrics  c('accuracy') )  history % fit( x  train_array, y  as.numeric(trainData$y), epochs  30, batch_size  100, validation_split  0.2 )  plot(history)   Your results should look like this. As the model trains epoch after epoch, cross-entropy (&#8216;loss&#8217;) is minimized in both training and validation splits. The apparent increase in the validation split after the 20th epoch is suggestive of slight overfitting. Accuracy, inversely proportional to cross-entropy, stalls at around 95% and 75% in training and validation splits, respectively. Pretty decent results on the fly. Let&#8217;s now investigate the performance on the test set. Recall we have no known labels for the 12,500 photographs that comprise the test set. Therefore, I propose taking 32 random images from the entire test set and visually inspect the predictions &#8211; classes and associated probabilities. Finally, we can store the model as a R object for future predictions.  # Compute probabilities and predictions on test set predictions &lt;-  predict_classes(model, test_array) probabilities &lt;- predict_proba(model, test_array)  # Visual inspection of 32 cases set.seed(100) random &lt;- sample(1:nrow(testData), 32) preds &lt;- predictions probs &lt;- as.vector(round(probabilities, 2))  par(mfrow  c(4, 8), mar  rep(0, 4)) for(i in 1:length(random)){ image(t(apply(test_array,,], 2, rev)), col  gray.colors(12), axes  F) legend(&quot;topright&quot;, legend  ifelse(preds  0, &quot;Cat&quot;, &quot;Dog&quot;), text.col  ifelse(preds  0, 2, 4), bty  &quot;n&quot;, text.font  2) legend(&quot;topleft&quot;, legend  probs, bty  &quot;n&quot;, col  &quot;white&quot;) }  # Save model save(model, file  &quot;CNNmodel.RData&quot;)   Noteworthy, many of the misclassifications depicted above are associated with , at with uncertainty is maximum. We could take advantage of this and introduce a &#8216;grey zone&#8217; in the prediction, for instance, by predicting dogs with\u00a0 and cats with\u00a0, while dismissing all other cases. Again, something worth covering in a future tutorial. I was really curious to test this CNN with my own two pets, Pitti &amp; Platsch, so I decided to give it a go. The half-sibs Princess Pitti (left) and Prince Platsch (right). I simply transformed their pictures above and ran\u00a0predict_classes\u00a0and\u00a0predict_proba\u00a0to determine the two predictions and associated probabilities, respectively. For my relief, the model identified both my pets as cats with relatively high certainty.  Wrap-up I hope you gained a basic understanding of CNNs and how to implement them using the Keras R interface in virtually any machine. I think this was a fun experiment that yielded a fairly good CNN model, being able to distinguish cats and dogs approximatelly 75% of the time, considering our frugal input setup. We could still set the bar higher. We could try boosting the validation accuracy using inputs larger than 50 x 50 px, RGB color channels (in which case the model inputs would be 4D tensors of shape 25000 x 50 x 50 x 3) and more elaborate architectures. I am afraid, however, that a substantial improvement will require some good specs. The Keras R interface can be intimidating for new users, but it is certainly a good starting point for the emerging deep learning enthusiasts, myself included. Finally, I am earnestly counting on your feedback for improvements, specially concerning clarity and any non-sense I might have written. Please, comment below or contact me directly. I also want to thank my beloved Isabel for reviewing my longest post ever. Now, if you will excuse me, I have to feed and clean after my masters.","keywords":"","datePublished":"2018-07-08T05:05:23-06:00","dateModified":"2018-07-08T05:05:23-06:00","author":{"@type":"Person","name":"Francisco Lima","description":"","url":"https:\/\/www.r-bloggers.com\/author\/francisco-lima\/","sameAs":["https:\/\/poissonisfish.wordpress.com"],"image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/9f61d698e6ffdd09c9f75b4facd9f860?s=96&d=mm&r=g","height":96,"width":96}},"publisher":{"@id":"https:\/\/www.r-bloggers.com#Organization"},"image":[{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/cats_dogs_trimmed_ppt_compress.png?w=1108","width":1108,"height":513,"@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#primaryimage"},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/tikz11.png?w=1108","width":597,"height":324},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=z+%3D+b+%2B+%5Csum_%7Bi+%3D+1%7D%5E%7Bm%7D+W_i+%5Ccdot+x_i+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":142,"height":19},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=f%28z%29+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":29,"height":18},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=CE+%3D+-+%5Csum_%7Bi+%3D+1%7D%5E%7Bn%7D+y_i+%5Ccdot+log%28%5Chat%7By_i%7D%29+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":173,"height":20},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=W%5E%7B%281%29%7D%2C+W%5E%7B%282%29%7D%2C+...+%2C+W%5E%7B%28l%29%7D&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=0","width":132,"height":18},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=L_2+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":17,"height":14},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=p_%7Bbird%7D+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":30,"height":10},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/cover.png?w=1108","width":1000,"height":341},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/convolution_schematic.gif?w=321&#038;h=235","width":268,"height":196},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/maxpool.jpeg?w=449&#038;h=210","width":449,"height":209},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/cat-1.jpg?w=1108","width":300,"height":280},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/example1.jpeg?w=1108","width":300,"height":300},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=P%28y+%3D+Dog%29+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":85,"height":18},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/slide1.jpg?w=1108","width":720,"height":540},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/acc.jpeg?w=1108","width":700,"height":300},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/val3.jpeg?w=694&#038;h=347","width":600,"height":300},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=P%28y+%3D+Dog%29+%5Capprox+0.50&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":137,"height":18},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=P%28y+%3D+Dog%29+%5Cgeqslant%C2%A00.75+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":137,"height":18},{"@type":"ImageObject","url":"https:\/\/s0.wp.com\/latex.php?latex=P%28y+%3D+Dog%29+%5Cleqslant+0.25+&#038;bg=f9f9f9&#038;%23038;fg=555555&#038;%23038;s=1","width":137,"height":18},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/drawing-e1531154540457.png?w=1108","width":1108,"height":496},{"@type":"ImageObject","url":"https:\/\/poissonisfish.files.wordpress.com\/2018\/07\/pittiplutsch.jpeg?w=1108","width":600,"height":300}],"isPartOf":{"@id":"https:\/\/www.r-bloggers.com\/2018\/07\/convolutional-neural-networks-in-r\/#webpage"}}]}]
</script>

    <script type="text/javascript">
        var snp_f = [];
        var snp_hostname = new RegExp(location.host);
        var snp_http = new RegExp("^(http|https)://", "i");
        var snp_cookie_prefix = '';
        var snp_separate_cookies = false;
        var snp_ajax_url = 'https://www.r-bloggers.com/wp-admin/admin-ajax.php';
		var snp_ajax_nonce = 'f9c7925ff0';
        var snp_ignore_cookies = false;
        var snp_enable_analytics_events = false;
        var snp_enable_mobile = false;
        var snp_use_in_all = false;
        var snp_excluded_urls = [];
        snp_excluded_urls.push('');    </script>
    <div class="snp-root">
        <input type="hidden" id="snp_popup" value="">
        <input type="hidden" id="snp_popup_id" value="">
        <input type="hidden" id="snp_popup_theme" value="">
        <input type="hidden" id="snp_exithref" value="">
        <input type="hidden" id="snp_exittarget" value="">
        	<div id="snppopup-welcome" class="snp-pop-109583 snppopup"><input type="hidden" class="snp_open" value="scroll"><input type="hidden" class="snp_show_on_exit" value="2"><input type="hidden" class="snp_exit_js_alert_text" value=""><input type="hidden" class="snp_exit_scroll_down" value=""><input type="hidden" class="snp_exit_scroll_up" value=""><input type="hidden" class="snp_open_scroll" value="50"><input type="hidden" class="snp_optin_redirect_url" value=""><input type="hidden" class="snp_show_cb_button" value="yes"><input type="hidden" class="snp_popup_id" value="109583"><input type="hidden" class="snp_popup_theme" value="theme6"><input type="hidden" class="snp_overlay" value="disabled"><input type="hidden" class="snp_cookie_conversion" value="30"><input type="hidden" class="snp_cookie_close" value="180"><div class="snp-fb snp-theme6">
    <div class="snp-subscribe-inner">
	<h1 class="snp-header"><i>Never miss an update! </i>
<br>
<strong>Subscribe to R-bloggers</strong> to receive <br>e-mails with the latest R posts.<br>

<small>(You will not see this message again.)</small></h1>	<div class="snp-form">
	    <form action="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" method="post" class="snp-subscribeform snp_subscribeform">
				<fieldset>
		    <div class="snp-field">
			<input type="text" name="email" id="snp_email" placeholder="Your E-mail..." class="snp-field snp-field-email">		
		    </div>
		    <button type="submit" class="snp-submit">Submit</button>
		</fieldset>
	    <input type="hidden" name="PnM-zH_AKJNfBeFs" value="v*TMZOlu5zynohG6"><input type="hidden" name="-cRxUiIS" value="6UaC7c1T"><input type="hidden" name="VXUxhtONi" value="Nc8akts2n"><input type="hidden" name="GyoDAYLMZ" value="yE2gzT5Zm"></form>
	</div>
	<a href="https://www.r-bloggers.com/2018/07/convolutional-neural-networks-in-r/#" class="snp_nothanks snp-close">Click here to close (This popup will not appear again)</a>    </div>
    </div>
<style>.snp-pop-109583 .snp-theme6 { max-width: 700px;}
.snp-pop-109583 .snp-theme6 h1 {font-size: 17px;}
.snp-pop-109583 .snp-theme6 { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field ::-webkit-input-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-moz-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-ms-input-placeholder { color: #a0a4a9;}
.snp-pop-109583  .snp-theme6 .snp-field input { border: 1px solid #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field { color: #000000;}
.snp-pop-109583 .snp-theme6 { background: #f2f2f2;}
</style><script type="text/javascript">
jQuery(document).ready(function() {
});
</script>
</div>        <script type="text/javascript">
            var CaptchaCallback = function() {
                jQuery('.g-recaptcha').each(function(index, el) {
                    grecaptcha.render(el, {
                        'sitekey' : ''
                    });
                });
            };
        </script>
    </div>
    <script type="text/javascript">/* <![CDATA[ */!function(e,n){var r={"selectors":{"block":"pre","inline":"code"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"scroll","linenumbers":false,"theme":"enlighter","language":"r","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""},"resources":["https:\/\/www.r-bloggers.com\/wp-content\/plugins\/enlighter\/cache\/enlighterjs.min.css?Dw2rFr2HgSGkY\/j","https:\/\/www.r-bloggers.com\/wp-content\/plugins\/enlighter\/resources\/enlighterjs\/enlighterjs.min.js"]},o=document.getElementsByTagName("head")[0],t=n&&(n.error||n.log)||function(){};e.EnlighterJSINIT=function(){!function(e,n){var r=0,l=null;function c(o){l=o,++r==e.length&&(!0,n(l))}e.forEach(function(e){switch(e.match(/\.([a-z]+)(?:[#?].*)?$/)[1]){case"js":var n=document.createElement("script");n.onload=function(){c(null)},n.onerror=c,n.src=e,n.async=!0,o.appendChild(n);break;case"css":var r=document.createElement("link");r.onload=function(){c(null)},r.onerror=c,r.rel="stylesheet",r.type="text/css",r.href=e,r.media="all",o.appendChild(r);break;default:t("Error: invalid file extension",e)}})}(r.resources,function(e){e?t("Error: failed to dynamically load EnlighterJS resources!",e):"undefined"!=typeof EnlighterJS?EnlighterJS.init(r.selectors.block,r.selectors.inline,r.options):t("Error: EnlighterJS resources not loaded yet!")})},(document.querySelector(r.selectors.block)||document.querySelector(r.selectors.inline))&&e.EnlighterJSINIT()}(window,console); /* ]]> */</script><script type="text/javascript" src="./Ejemplo_RBloggers_files/jquery.ck.min.js.descarga" id="jquery-np-cookie-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/dialog_trigger.js.descarga" id="js-dialog_trigger-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/ninjapopups.min.js.descarga" id="js-ninjapopups-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/jquery.fancybox.min.js.descarga" id="fancybox2-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/photon.min.js.descarga" id="jetpack-photon-js"></script>
<script type="text/javascript" id="flying-pages-js-before">
window.FPConfig= {
	delay: 0,
	ignoreKeywords: ["\/wp-admin","\/wp-login.php","\/cart","add-to-cart","logout","#","?",".png",".jpeg",".jpg",".gif",".svg"],
	maxRPS: 3,
    hoverDelay: 50
};
</script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/flying-pages.min.js.descarga" id="flying-pages-js" defer=""></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/devicepx-jetpack.js.descarga" id="devicepx-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/lazy-images.min.js.descarga" id="jetpack-lazy-images-js"></script>
<script type="text/javascript" src="./Ejemplo_RBloggers_files/wp-embed.min.js.descarga" id="wp-embed-js"></script>
<script async="async" type="text/javascript" src="./Ejemplo_RBloggers_files/e-202048.js.descarga" defer="defer"></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:7.3.2',blog:'11524731',post:'164887',tz:'-6',srv:'www.r-bloggers.com'} ]);
	_stq.push([ 'clickTrackerInit', '11524731', '164887' ]);
</script>
	<script type="text/javascript">
        jQuery(document).ready(function ($) {
            //$( document ).ajaxStart(function() {
            //});

			
            for (var i = 0; i < document.forms.length; ++i) {
                var form = document.forms[i];
				if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="PnM-zH_AKJNfBeFs" value="v*TMZOlu5zynohG6" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="-cRxUiIS" value="6UaC7c1T" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="VXUxhtONi" value="Nc8akts2n" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="GyoDAYLMZ" value="yE2gzT5Zm" />'); }
            }

			
            $(document).on('submit', 'form', function () {
				if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="PnM-zH_AKJNfBeFs" value="v*TMZOlu5zynohG6" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="-cRxUiIS" value="6UaC7c1T" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="VXUxhtONi" value="Nc8akts2n" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="GyoDAYLMZ" value="yE2gzT5Zm" />'); }
                return true;
            });

			
            jQuery.ajaxSetup({
                beforeSend: function (e, data) {

                    //console.log(Object.getOwnPropertyNames(data).sort());
                    //console.log(data.type);

                    if (data.type !== 'POST') return;

                    if (typeof data.data === 'object' && data.data !== null) {
						data.data.append("PnM-zH_AKJNfBeFs", "v*TMZOlu5zynohG6");
data.data.append("-cRxUiIS", "6UaC7c1T");
data.data.append("VXUxhtONi", "Nc8akts2n");
data.data.append("GyoDAYLMZ", "yE2gzT5Zm");
                    }
                    else {
                        data.data =  data.data + '&PnM-zH_AKJNfBeFs=v*TMZOlu5zynohG6&-cRxUiIS=6UaC7c1T&VXUxhtONi=Nc8akts2n&GyoDAYLMZ=yE2gzT5Zm';
                    }
                }
            });

        });
	</script>
	

<!-- Dynamic page generated in 6.853 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2020-11-23 07:29:26 -->

<!-- Compression = gzip --><img src="./Ejemplo_RBloggers_files/g.gif" alt=":)" width="6" height="5" id="wpstats"></body></html>